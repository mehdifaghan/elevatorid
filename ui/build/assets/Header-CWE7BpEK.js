import{a1 as N,r as d,j as e,a2 as o,ay as E,az as A,B as y,u as W,a as R,i as O,V as T,o as M,J as L,U as z,H as B}from"./index-tH8kGzNV.js";import{A as U,a as H,b as P}from"./avatar-MaNl8m6v.js";import{D as K,a as $,b as V,e as F,d as _,c as k}from"./dropdown-menu-BKfQT_JD.js";import{R as q,C as G,a as X,b as J,D as Y,P as Q,O as Z}from"./index-DGGMjIYi.js";import{X as ee}from"./x-B6dSK8zO.js";import{T as te,a as ae,b as se,c as re}from"./tooltip-CkdpyXMD.js";import{r as ne}from"./real-api-client-o-2gE2Hp.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],Oe=N("layout-dashboard",ie);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],Te=N("log-out",oe);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],le=N("panel-left",de);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],ue=N("wallet",ce),C=768;function he(){const[t,a]=d.useState(void 0);return d.useEffect(()=>{const r=window.matchMedia(`(max-width: ${C-1}px)`),s=()=>{a(window.innerWidth<C)};return r.addEventListener("change",s),a(window.innerWidth<C),()=>r.removeEventListener("change",s)},[]),!!t}function me({...t}){return e.jsx(q,{"data-slot":"sheet",...t})}function fe({...t}){return e.jsx(Q,{"data-slot":"sheet-portal",...t})}function pe({className:t,...a}){return e.jsx(Z,{"data-slot":"sheet-overlay",className:o("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function be({className:t,children:a,side:r="right",...s}){return e.jsxs(fe,{children:[e.jsx(pe,{}),e.jsxs(G,{"data-slot":"sheet-content",className:o("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",r==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",r==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",r==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",r==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",t),...s,children:[a,e.jsxs(X,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[e.jsx(ee,{className:"size-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function xe({className:t,...a}){return e.jsx("div",{"data-slot":"sheet-header",className:o("flex flex-col gap-1.5 p-4",t),...a})}function ge({className:t,...a}){return e.jsx(J,{"data-slot":"sheet-title",className:o("text-foreground font-semibold",t),...a})}function ve({className:t,...a}){return e.jsx(Y,{"data-slot":"sheet-description",className:o("text-muted-foreground text-sm",t),...a})}const we="sidebar_state",je=3600*24*7,ye="16rem",Ne="18rem",Se="3rem",ke="b",I=d.createContext(null);function D(){const t=d.useContext(I);if(!t)throw new Error("useSidebar must be used within a SidebarProvider.");return t}function Le({defaultOpen:t=!0,open:a,onOpenChange:r,className:s,style:n,children:m,...f}){const c=he(),[b,u]=d.useState(!1),[p,w]=d.useState(t),x=a??p,g=d.useCallback(i=>{const h=typeof i=="function"?i(x):i;r?r(h):w(h),document.cookie=`${we}=${h}; path=/; max-age=${je}`},[r,x]),v=d.useCallback(()=>c?u(i=>!i):g(i=>!i),[c,g,u]);d.useEffect(()=>{const i=h=>{h.key===ke&&(h.metaKey||h.ctrlKey)&&(h.preventDefault(),v())};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[v]);const j=x?"expanded":"collapsed",l=d.useMemo(()=>({state:j,open:x,setOpen:g,isMobile:c,openMobile:b,setOpenMobile:u,toggleSidebar:v}),[j,x,g,c,b,u,v]);return e.jsx(I.Provider,{value:l,children:e.jsx(te,{delayDuration:0,children:e.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":ye,"--sidebar-width-icon":Se,...n},className:o("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",s),...f,children:m})})})}function ze({side:t="left",variant:a="sidebar",collapsible:r="offcanvas",className:s,children:n,...m}){const{isMobile:f,state:c,openMobile:b,setOpenMobile:u}=D();return r==="none"?e.jsx("div",{"data-slot":"sidebar",className:o("bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col",s),...m,children:n}):f?e.jsx(me,{open:b,onOpenChange:u,...m,children:e.jsxs(be,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden",style:{"--sidebar-width":Ne},side:t,children:[e.jsxs(xe,{className:"sr-only",children:[e.jsx(ge,{children:"Sidebar"}),e.jsx(ve,{children:"Displays the mobile sidebar."})]}),e.jsx("div",{className:"flex h-full w-full flex-col",children:n})]})}):e.jsxs("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":c,"data-collapsible":c==="collapsed"?r:"","data-variant":a,"data-side":t,"data-slot":"sidebar",children:[e.jsx("div",{"data-slot":"sidebar-gap",className:o("relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",a==="floating"||a==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon)")}),e.jsx("div",{"data-slot":"sidebar-container",className:o("fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex",t==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",a==="floating"||a==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l",s),...m,children:e.jsx("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:n})})]})}function Ce({className:t,onClick:a,...r}){const{toggleSidebar:s}=D();return e.jsxs(y,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:o("size-7",t),onClick:n=>{a?.(n),s()},...r,children:[e.jsx(le,{}),e.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function Be({className:t,...a}){return e.jsx("div",{"data-slot":"sidebar-header","data-sidebar":"header",className:o("flex flex-col gap-2 p-2",t),...a})}function Ue({className:t,...a}){return e.jsx("div",{"data-slot":"sidebar-footer","data-sidebar":"footer",className:o("flex flex-col gap-2 p-2",t),...a})}function He({className:t,...a}){return e.jsx("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:o("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",t),...a})}function Pe({className:t,...a}){return e.jsx("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:o("relative flex w-full min-w-0 flex-col p-2",t),...a})}function Ke({className:t,...a}){return e.jsx("div",{"data-slot":"sidebar-group-content","data-sidebar":"group-content",className:o("w-full text-sm",t),...a})}function $e({className:t,...a}){return e.jsx("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:o("flex w-full min-w-0 flex-col gap-1",t),...a})}function Ve({className:t,...a}){return e.jsx("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:o("group/menu-item relative",t),...a})}const De=A("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function Fe({asChild:t=!1,isActive:a=!1,variant:r="default",size:s="default",tooltip:n,className:m,...f}){const c=t?E:"button",{isMobile:b,state:u}=D(),p=e.jsx(c,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":s,"data-active":a,className:o(De({variant:r,size:s}),m),...f});return n?(typeof n=="string"&&(n={children:n}),e.jsxs(ae,{children:[e.jsx(se,{asChild:!0,children:p}),e.jsx(re,{side:"right",align:"center",hidden:u!=="collapsed"||b,...n})]})):p}function qe(){const{user:t,logout:a}=W(),r=R(),s=O(),[n,m]=d.useState(null),[f,c]=d.useState(!1),[b,u]=d.useState(null),p=s.pathname.startsWith("/api/user")||s.pathname.startsWith("/demo/user")||s.pathname.startsWith("/user")&&t?.role==="user";s.pathname.startsWith("/api/user")||s.pathname.startsWith("/user")&&t?.role;const w=async()=>{if(p){c(!0),u(null);try{if(s.pathname.startsWith("/demo/user")){await new Promise(i=>setTimeout(i,500));const l={balance:245e4,currency:"IRR",lastUpdate:new Date().toLocaleDateString("fa-IR")};m(l)}else{const l=await ne.get("/user/wallet/balance");m(l)}}catch(l){const i=l;u(i.message),console.error("Error fetching wallet info:",i)}finally{c(!1)}}};d.useEffect(()=>{p?w():(m(null),u(null))},[p,s.pathname]);const x=l=>new Intl.NumberFormat("fa-IR",{style:"currency",currency:"IRR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l).replace("IRR","ریال"),g=()=>{a()},v=()=>{const l=s.pathname.startsWith("/demo/admin"),i=s.pathname.startsWith("/demo/user"),h=s.pathname.startsWith("/admin")&&t?.role==="admin",S=s.pathname.startsWith("/user")&&t?.role==="user";l?r("/demo/admin/profile"):i?r("/demo/user/profile"):h?r("/admin/profile"):S&&r("/user/profile")},j=()=>{const l=s.pathname.startsWith("/demo/admin"),i=s.pathname.startsWith("/demo/user"),h=s.pathname.startsWith("/admin")&&t?.role==="admin",S=s.pathname.startsWith("/user")&&t?.role==="user";l?r("/demo/admin/settings"):i?r("/demo/user/settings"):h?r("/admin/settings"):S&&r("/user/settings")};return e.jsx("header",{className:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 sticky top-0 z-50",children:e.jsxs("div",{className:"flex h-16 items-center px-4 sm:px-6",children:[e.jsx("div",{className:"flex items-center",children:e.jsx(Ce,{})}),e.jsx("div",{className:"flex-1 text-center px-4",children:e.jsx("h1",{className:"font-semibold text-sm sm:text-base truncate",children:"سامانه ردیابی قطعات و شناسنامه آسانسور"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[p&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(y,{variant:"outline",size:"sm",className:"gap-2 px-3 bg-green-50 border-green-200 hover:bg-green-100 text-green-800",onClick:w,disabled:f,title:n?`آخرین به‌روزرسانی: ${n.lastUpdate}`:"کیف پول",children:[f?e.jsx(T,{className:"h-4 w-4 animate-spin"}):e.jsx(ue,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline text-sm font-medium",children:n?x(n.balance):b?"خطا":f?"بارگذاری...":"کیف پول"}),e.jsx("span",{className:"sm:hidden text-xs font-bold",children:n&&e.jsxs(M,{variant:"secondary",className:"bg-green-100 text-green-800 text-xs",children:[Math.floor(n.balance/1e3),"K"]})})]})}),e.jsxs(y,{variant:"ghost",size:"sm",className:"relative hidden sm:flex",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx(M,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 text-xs flex items-center justify-center",children:"3"})]}),e.jsxs(K,{children:[e.jsx($,{asChild:!0,children:e.jsxs(y,{variant:"ghost",size:"sm",className:"gap-2 px-2 sm:px-3",children:[e.jsxs(U,{className:"h-7 w-7",children:[e.jsx(H,{}),e.jsx(P,{className:"text-xs",children:t?.username?.charAt(0).toUpperCase()||"U"})]}),e.jsx("span",{className:"hidden sm:inline text-sm max-w-20 truncate",children:t?.username})]})}),e.jsxs(V,{align:"end",className:"w-56",children:[e.jsx(F,{className:"text-right",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:t?.username||"کاربر نمونه"}),t?.role!=="admin"&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["کد شرکت: CMP-",(t?.id||1001).toString().padStart(6,"0")]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t?.email||t?.mobile||"حالت دمو"})]})}),e.jsx(_,{}),e.jsxs(k,{className:"cursor-pointer justify-end gap-2 focus:bg-accent",onClick:v,children:[e.jsx("span",{children:"پروفایل"}),e.jsx(z,{className:"w-4 h-4"})]}),e.jsxs(k,{className:"cursor-pointer justify-end gap-2 focus:bg-accent",onClick:j,children:[e.jsx("span",{children:"تنظیمات"}),e.jsx(B,{className:"w-4 h-4"})]}),e.jsx(_,{}),e.jsx(k,{className:"cursor-pointer text-destructive focus:text-destructive focus:bg-destructive/10 justify-end gap-2",onClick:g,children:e.jsx("span",{children:"خروج"})})]})]})]})]})})}export{qe as H,Oe as L,ze as S,Be as a,He as b,Pe as c,Ke as d,$e as e,Ve as f,Fe as g,Ue as h,Te as i,Le as j};
