import{r as l,t as w,j as e,B as m,C as o,e as x,b as X,c as Y,d as Z,p as _,V as ee,O as se,W as P,v as te,o as u,w as g,U as ae,G as le,Q as re}from"./index-tH8kGzNV.js";import{T as ne,a as ce,b as F,c as r,d as ie,e as n}from"./table-DC3MYrD8.js";import{D as de,b as oe,c as xe,d as me,e as he}from"./dialog-DAjwwShP.js";import{D as je,a as pe,b as ue,c as ge}from"./dropdown-menu-BKfQT_JD.js";import{S as L,a as E,b as M,c as B,d as c}from"./select-B8NiX_r6.js";import{a as Ne,S as fe}from"./SellModal-B1TPinsx.js";import{r as be}from"./real-api-client-o-2gE2Hp.js";import{S as ve}from"./search-8LTSveb2.js";import{C as we}from"./clock-BiwlPOks.js";import{E as ye}from"./ellipsis-J_HkHiqq.js";import{F as Se}from"./file-text-DbNNqFYp.js";import{D as Ce}from"./download-BGqk_jGh.js";import{P as De}from"./printer-DtKxBXsK.js";import"./index-DGGMjIYi.js";import"./Combination-Dzecd94B.js";import"./x-B6dSK8zO.js";import"./chevron-right-B97jr1RJ.js";import"./check-DV_4N94Y.js";import"./index-BdQq_4o_.js";import"./index-BuiImgyP.js";import"./PersianDatePicker-1MwY2jFT.js";import"./popover-B3pW-y7H.js";import"./utils-BvTIn9cQ.js";const V={pending:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"},$={pending:"در انتظار",completed:"تکمیل شده",cancelled:"لغو شده"},z={pending:we,completed:P,cancelled:se},H={incoming:"دریافتی",outgoing:"ارسالی"},A={incoming:"text-green-600",outgoing:"text-blue-600"};function Ye(){const[t,h]=l.useState([]),[O,y]=l.useState(!0),[j,U]=l.useState(""),[N,q]=l.useState("all"),[f,G]=l.useState("all"),[b,S]=l.useState(null),[C,D]=l.useState(!1),[i,T]=l.useState(null),[v,R]=l.useState(!1),[d,I]=l.useState({total:0,pending:0,completed:0,cancelled:0,incoming:0,outgoing:0});l.useEffect(()=>{k()},[]);const k=async()=>{try{y(!0);const a=(await be.get("/user/transfers")).data.transfers||[];h(a),I(Q(a))}catch(s){console.error("Error fetching transfers:",s),w.error("خطا در بارگذاری اطلاعات انتقالات"),h([]),I({total:0,pending:0,completed:0,cancelled:0,incoming:0,outgoing:0})}finally{y(!1)}},Q=s=>({total:s.length,pending:s.filter(a=>a.status==="pending").length,completed:s.filter(a=>a.status==="completed").length,cancelled:s.filter(a=>a.status==="cancelled").length,incoming:s.filter(a=>a.direction==="incoming").length,outgoing:s.filter(a=>a.direction==="outgoing").length}),p=t.filter(s=>{const a=s.partName.toLowerCase().includes(j.toLowerCase())||s.partSerial.toLowerCase().includes(j.toLowerCase())||s.otherCompanyName.toLowerCase().includes(j.toLowerCase()),J=N==="all"||s.status===N,K=f==="all"||s.direction===f;return a&&J&&K}),W=async()=>{R(!0),await k(),R(!1),w.success("داده‌ها با موفقیت به‌روزرسانی شد")};return O?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:"در حال بارگذاری انتقالات..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"انتقال‌های قطعات"}),e.jsx("p",{className:"text-muted-foreground",children:"تاریخچه انتقال‌های دریافتی و ارسالی"})]}),e.jsxs(m,{className:"bg-black hover:bg-gray-800 text-white",onClick:()=>{p.length>0?(T(p[0]),D(!0)):w.error("🛒 هیچ انتقالی برای فروش یافت نشد",{description:"در حال حاضر قطعه‌ای برای فروش موجود نیست",duration:4e3})},children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"فروش قطعه"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx(o,{className:"border-l-4 border-l-blue-500",children:e.jsx(x,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold text-blue-600",children:d.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"کل انتقال‌ها"})]})})}),e.jsx(o,{className:"border-l-4 border-l-yellow-500",children:e.jsx(x,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:d.pending}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"در انتظار"})]})})}),e.jsx(o,{className:"border-l-4 border-l-green-500",children:e.jsx(x,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold text-green-600",children:d.completed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"تکمیل شده"})]})})}),e.jsx(o,{className:"border-l-4 border-l-indigo-500",children:e.jsx(x,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold text-indigo-600",children:d.incoming+d.outgoing}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"مجموع تبادل"})]})})})]}),e.jsxs(o,{children:[e.jsxs(X,{children:[e.jsx(Y,{children:"لیست انتقال‌ها"}),e.jsx(Z,{children:"مدیریت و مشاهده انتقال‌های قطعات"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ve,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(_,{placeholder:"جستجو در انتقال‌ها...",value:j,onChange:s=>U(s.target.value),className:"pr-10"})]}),e.jsxs(m,{variant:"outline",size:"sm",onClick:W,disabled:v,className:"gap-2 shrink-0",children:[e.jsx(ee,{className:`h-4 w-4 ${v?"animate-spin":""}`}),v?"در حال بارگذاری...":"تازه‌سازی"]}),e.jsxs(L,{value:N,onValueChange:q,children:[e.jsx(E,{className:"w-full md:w-40",children:e.jsx(M,{placeholder:"وضعیت"})}),e.jsxs(B,{children:[e.jsx(c,{value:"all",children:"همه وضعیت‌ها"}),e.jsx(c,{value:"pending",children:"در انتظار"}),e.jsx(c,{value:"completed",children:"تکمیل شده"}),e.jsx(c,{value:"cancelled",children:"لغو شده"})]})]}),e.jsxs(L,{value:f,onValueChange:G,children:[e.jsx(E,{className:"w-full md:w-40",children:e.jsx(M,{placeholder:"نوع"})}),e.jsxs(B,{children:[e.jsx(c,{value:"all",children:"همه انواع"}),e.jsx(c,{value:"incoming",children:"دریافتی"}),e.jsx(c,{value:"outgoing",children:"ارسالی"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ne,{children:[e.jsx(ce,{children:e.jsxs(F,{children:[e.jsx(r,{children:"قطعه"}),e.jsx(r,{children:"نوع انتقال"}),e.jsx(r,{children:"شرکت مقابل"}),e.jsx(r,{children:"تاریخ"}),e.jsx(r,{children:"دلیل"}),e.jsx(r,{children:"وضعیت"}),e.jsx(r,{children:"عملیات"})]})}),e.jsx(ie,{children:p.map(s=>{const a=z[s.status];return e.jsxs(F,{children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.partName}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.partSerial})]})]})}),e.jsx(n,{children:e.jsxs(u,{variant:"outline",className:`${A[s.direction]} flex items-center gap-1 w-fit`,children:[e.jsx(g,{className:"w-3 h-3"}),H[s.direction]]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-gray-500"}),s.otherCompanyName]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-gray-500"}),s.transferDate]})}),e.jsx(n,{children:s.reason}),e.jsx(n,{children:e.jsxs(u,{variant:"secondary",className:`${V[s.status]} flex items-center gap-1 w-fit`,children:[e.jsx(a,{className:"w-3 h-3"}),$[s.status]]})}),e.jsx(n,{children:e.jsxs(je,{children:[e.jsx(pe,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"sm",children:e.jsx(ye,{className:"w-4 h-4"})})}),e.jsx(ue,{align:"end",dir:"rtl",children:e.jsxs(ge,{onClick:()=>S(s),children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"مشاهده جزئیات"]})})]})})]},s.id)})})]})}),p.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(g,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"انتقالی یافت نشد"})]})]})]}),b&&e.jsx(de,{open:!!b,onOpenChange:()=>S(null),children:e.jsxs(oe,{className:"max-w-4xl max-h-[90vh] overflow-hidden",dir:"rtl",children:[e.jsxs(xe,{className:"text-right",children:[e.jsx(me,{className:"text-right",children:"جزئیات انتقال"}),e.jsx(he,{className:"text-right",children:"اطلاعات کامل انتقال قطعه و تولید مدارک"})]}),e.jsx("div",{className:"modal-scroll-container",children:e.jsx(Te,{transfer:b})})]})}),C&&i&&e.jsx(fe,{isOpen:C,onClose:()=>{D(!1),T(null)},preSelectedPart:{id:i.partId,name:i.partName,code:i.partSerial,serial:i.partSerial,category:"قطعات الکتریکی"},title:"فروش قطعه",description:"انجام فرآیند فروش قطعه از طریق انتقال"})]})}function Te({transfer:t}){const h=z[t.status];return e.jsxs("div",{className:"space-y-6",dir:"rtl","data-transfer-modal-content":!0,children:[e.jsxs("div",{className:"text-center border-b-2 border-primary pb-4 header",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[e.jsx(g,{className:"w-8 h-8 text-primary"}),e.jsx("h2",{className:"text-2xl font-bold text-primary",children:"برگه انتقال قطعه"})]}),e.jsx("h3",{className:"text-lg text-muted-foreground",children:"سامانه ردیابی قطعات و شناسنامه آسانسور"}),e.jsxs("p",{className:"text-muted-foreground",children:["شماره انتقال: ",t.id.padStart(8,"0")]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["تاریخ صدور: ",new Date().toLocaleDateString("fa-IR")]})]}),e.jsxs("div",{className:"border rounded-lg p-6 bg-gradient-to-r from-orange-50 to-orange-100 section",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 section-title",children:[e.jsx(g,{className:"w-5 h-5 text-orange-600"}),e.jsx("h3",{className:"text-lg font-bold text-orange-800",children:"اطلاعات انتقال"})]}),e.jsxs("div",{className:"section-content",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between border-b border-orange-200 pb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"نام قطعه:"}),e.jsx("span",{className:"font-medium",children:t.partName})]}),e.jsxs("div",{className:"flex justify-between border-b border-orange-200 pb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"شماره سریال:"}),e.jsx("span",{className:"font-medium font-mono",children:t.partSerial})]}),e.jsxs("div",{className:"flex justify-between border-b border-orange-200 pb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"نوع انتقال:"}),e.jsx(u,{variant:"outline",className:`${A[t.direction]}`,children:H[t.direction]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between border-b border-orange-200 pb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"شرکت مقابل:"}),e.jsx("span",{className:"font-medium",children:t.otherCompanyName})]}),e.jsxs("div",{className:"flex justify-between border-b border-orange-200 pb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"تاریخ انتقال:"}),e.jsx("span",{className:"font-medium",children:t.transferDate})]}),e.jsxs("div",{className:"flex justify-between border-b border-orange-200 pb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"دلیل انتقال:"}),e.jsx("span",{className:"font-medium",children:t.reason})]})]})]}),t.notes&&e.jsxs("div",{className:"mt-4 p-3 bg-orange-200 rounded-lg",children:[e.jsx("p",{className:"font-medium text-orange-700 mb-1",children:"یادداشت:"}),e.jsx("p",{className:"text-orange-800",children:t.notes})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-6 bg-gradient-to-r from-purple-50 to-purple-100 section",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 section-title",children:[e.jsx(P,{className:"w-5 h-5 text-purple-600"}),e.jsx("h3",{className:"text-lg font-bold text-purple-800",children:"وضعیت انتقال"})]}),e.jsxs("div",{className:"text-center section-content",children:[e.jsxs(u,{variant:"secondary",className:`${V[t.status]} text-lg px-6 py-2 flex items-center gap-2 justify-center w-fit mx-auto`,children:[e.jsx(h,{className:"w-4 h-4"}),$[t.status]]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["آخرین به‌روزرسانی: ",t.transferDate]})]})]}),e.jsxs("div",{className:"text-center pt-6 border-t border-gray-300",children:[e.jsxs("div",{className:"mb-4 flex gap-4 justify-center",children:[e.jsxs(m,{onClick:()=>window.print(),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 gap-2",size:"lg",children:[e.jsx(Se,{className:"h-5 w-5"}),"صدور PDF",e.jsx(Ce,{className:"h-4 w-4"})]}),e.jsxs(m,{onClick:()=>window.print(),variant:"outline",className:"border-blue-600 text-blue-600 hover:bg-blue-50 px-6 py-3 gap-2",size:"lg",children:[e.jsx(De,{className:"h-5 w-5"}),"چاپ برگه"]})]}),e.jsxs("div",{className:"footer",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"این برگه توسط سامانه جامع ردیابی قطعات و شناسنامه آسانسور تولید شده است"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["تاریخ تولید: ",new Date().toLocaleDateString("fa-IR")," - ساعت: ",new Date().toLocaleTimeString("fa-IR")]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"🌐 https://elevatorid.ieeu.ir"})]})]})]})}export{Ye as default};
