import{r as m,$ as U,j as e,x as S,C as f,e as P,p as C,b as Y,c as Z,a0 as ee,o as y,B as c,L as j,v as se,t as w}from"./index-tH8kGzNV.js";import{T as te,a as ae,b as R,c as x,d as ne,e as h}from"./table-DC3MYrD8.js";import{D as le,a as ie,b as re,c as ce,d as de,e as me}from"./dialog-DAjwwShP.js";import{S as V,a as L,b as z,c as F,d as N}from"./select-B8NiX_r6.js";import{I as xe}from"./info-BmNqUgv1.js";import{S as he}from"./search-8LTSveb2.js";import{F as oe}from"./folder-tree-CoiUlgID.js";import{P as T}from"./plus-A2-5MgKF.js";import{X as ue}from"./x-B6dSK8zO.js";import{P as pe}from"./pen-CJgjb0UZ.js";import{T as je}from"./trash-2-BwVZTJjK.js";import"./index-DGGMjIYi.js";import"./Combination-Dzecd94B.js";import"./index-BdQq_4o_.js";import"./index-BuiImgyP.js";import"./check-DV_4N94Y.js";const $={موتور:"🔧",کنترل:"⚡",ایمنی:"🛡️",کابین:"🏠",درب:"🚪",کابل:"🔗",مکانیکی:"⚙️",الکترونیک:"💻",هیدرولیک:"💧"},Ne=[{id:"1",name:"موتور",technicalSpecs:[{name:"قدرت",type:"number",unit:"HP"},{name:"ولتاژ",type:"number",unit:"V"},{name:"دور در دقیقه",type:"number",unit:"RPM"}]},{id:"1-1",name:"موتور AC",parentId:"1",technicalSpecs:[{name:"قدرت",type:"number",unit:"HP"},{name:"ولتاژ ورودی",type:"number",unit:"V"},{name:"فرکانس",type:"number",unit:"Hz"},{name:"نوع روتور",type:"list",unit:"قفسه سنجابی/حلقه‌ای"}]},{id:"1-2",name:"موتور DC",parentId:"1",technicalSpecs:[{name:"قدرت",type:"number",unit:"HP"},{name:"ولتاژ",type:"number",unit:"V"},{name:"جریان",type:"number",unit:"A"},{name:"نوع کموتاتور",type:"list",unit:"کربنی/مسی"}]},{id:"2",name:"کنترل کننده",technicalSpecs:[{name:"نوع ورودی",type:"text",unit:""},{name:"تعداد طبقات",type:"number",unit:"طبقه"},{name:"نوع ارتباط",type:"list",unit:"RS485/CAN/Ethernet"}]},{id:"2-1",name:"کنترلر فرکانس",parentId:"2",technicalSpecs:[{name:"قدرت",type:"number",unit:"KW"},{name:"ولتاژ ورودی",type:"number",unit:"V"},{name:"محدوده فرکانس",type:"text",unit:"Hz"},{name:"نوع کنترل",type:"list",unit:"V/f/Vector/DTC"}]},{id:"3",name:"کابل",technicalSpecs:[{name:"قطر",type:"number",unit:"mm"},{name:"ظرفیت جریان",type:"number",unit:"A"},{name:"ولتاژ مجاز",type:"number",unit:"V"}]}],ge=[{id:"1",name:"آسانسور هیدرولیک",description:"آسانسور با سیستم هیدرولیک مناسب برای ساختمان‌های کم طبقه تا 6 طبقه",isActive:!0,createdAt:"۱۴۰۲/۰۹/۱۵"},{id:"2",name:"آسانسور کششی",description:"آسانسور با سیستم کششی شامل MRL (بدون موتورخانه) و کلاسیک (با موتورخانه) مناسب برای ساختمان‌های بلند",isActive:!0,createdAt:"۱۴۰۲/۰۹/۱۴"}];function Le({triggerDialog:D}){const[o,B]=m.useState(null),[M,fe]=m.useState(ge),[i,k]=m.useState(Ne),[v,O]=m.useState(""),[r,d]=m.useState({name:"",parentId:void 0,technicalSpecs:[{name:"",type:"text",unit:""}]}),[u,g]=m.useState(null),[q,p]=m.useState(!1),b=()=>{d({name:"",parentId:void 0,technicalSpecs:[{name:"",type:"text",unit:""}]})};U.useEffect(()=>{D&&(b(),g(null),p(!0))},[D]);const K=()=>{d(s=>({...s,technicalSpecs:[...s.technicalSpecs,{name:"",type:"text",unit:""}]}))},W=s=>{r.technicalSpecs.length>1&&d(a=>({...a,technicalSpecs:a.technicalSpecs.filter((t,l)=>l!==s)}))},I=(s,a,t)=>{d(l=>({...l,technicalSpecs:l.technicalSpecs.map((n,A)=>A===s?{...n,[a]:t}:n)}))},X=s=>{if(s.preventDefault(),!r.name.trim()){w.error("نام دسته‌بندی الزامی است");return}const a=r.technicalSpecs.filter(n=>n.name.trim()&&n.type&&n.unit.trim()),t={id:u?.id||Date.now().toString(),name:r.name.trim(),parentId:r.parentId,technicalSpecs:a.length>0?a:void 0};let l;u?(l=i.map(n=>n.id===u.id?t:n),w.success("دسته‌بندی بروزرسانی شد")):(l=[...i,t],w.success("دسته‌بندی جدید ایجاد شد")),k(l),p(!1),b(),g(null)},_=s=>{g(s),d({name:s.name,parentId:s.parentId,technicalSpecs:s.technicalSpecs?.length?s.technicalSpecs:[{name:"",type:"text",unit:""}]}),p(!0)},G=s=>{if(window.confirm(`آیا از حذف دسته‌بندی "${s.name}" اطمینان دارید؟`)){const a=i.filter(t=>t.id!==s.id);k(a),w.success("دسته‌بندی حذف شد")}},J=s=>{B(s)},E=s=>{if(!s.parentId)return s.name;const a=i.find(t=>t.id===s.parentId);return a?`${E(a)} / ${s.name}`:s.name},Q=()=>{const a=i.map(t=>({...t,hierarchy:E(t),isParent:!t.parentId,parentName:t.parentId?i.find(l=>l.id===t.parentId)?.name||"والد موجود نیست":"-",techSpecsCount:t.technicalSpecs?.length||0})).sort((t,l)=>t.isParent&&!l.isParent?-1:!t.isParent&&l.isParent?1:t.hierarchy.localeCompare(l.hierarchy,"fa"));return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(R,{children:[e.jsx(x,{className:"text-right w-12",children:"#"}),e.jsx(x,{className:"text-right",children:"نام دسته‌بندی"}),e.jsx(x,{className:"text-right",children:"سلسله مراتب"}),e.jsx(x,{className:"text-right",children:"والد"}),e.jsx(x,{className:"text-right",children:"نوع"}),e.jsx(x,{className:"text-right",children:"مشخصات فنی"}),e.jsx(x,{className:"text-right w-32",children:"عملیات"})]})}),e.jsx(ne,{children:a.map((t,l)=>e.jsxs(R,{className:`
                  ${t.isParent?"bg-blue-50/50 hover:bg-blue-50/70":i.find(n=>n.id===t.parentId)?"bg-green-50/30 hover:bg-green-50/50":"bg-yellow-50/50 hover:bg-yellow-50/70"}
                `,children:[e.jsx(h,{className:"text-right font-medium",children:l+1}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:$[t.name]||"📦"}),e.jsx("span",{className:"font-medium",children:t.name})]})}),e.jsx(h,{className:"text-right",children:e.jsx("span",{className:"text-sm text-muted-foreground",children:t.hierarchy})}),e.jsx(h,{className:"text-right",children:e.jsx("span",{className:`text-sm ${t.parentName==="والد موجود نیست"?"text-red-600":t.parentName==="-"?"text-gray-500":"text-gray-700"}`,children:t.parentName})}),e.jsx(h,{className:"text-right",children:e.jsx(y,{variant:t.isParent?"default":i.find(n=>n.id===t.parentId)?"secondary":"destructive",className:"text-xs",children:t.isParent?"دسته‌بندی اصلی":i.find(n=>n.id===t.parentId)?"زیر دسته‌بندی":"یتیم"})}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("span",{className:"text-sm font-medium",children:[t.techSpecsCount," مشخصه"]}),t.technicalSpecs&&t.technicalSpecs.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.technicalSpecs.slice(0,2).map((n,A)=>e.jsx(y,{variant:"outline",className:"text-xs",children:n.name},A)),t.technicalSpecs.length>2&&e.jsxs(y,{variant:"outline",className:"text-xs",children:["+",t.technicalSpecs.length-2]})]})]})}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(c,{variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50 h-8 w-8 p-0",onClick:()=>_(t),children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(c,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 w-8 p-0",onClick:()=>G(t),children:e.jsx(je,{className:"h-4 w-4"})})]})})]},t.id))})]})}),a.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"هیچ دسته‌بندی‌ای برای این نوع آسانسور تعریف نشده است"})})]})},H=M.filter(s=>s.name.toLowerCase().includes(v.toLowerCase())||s.description.toLowerCase().includes(v.toLowerCase()));return o?e.jsxs("div",{className:"space-y-6",style:{direction:"rtl"},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5 text-green-600"}),e.jsxs("h3",{className:"text-lg font-semibold",children:["دسته‌بندی قطعات: ",o.name]})]}),e.jsxs(le,{open:q,onOpenChange:p,children:[e.jsx(ie,{asChild:!0,children:e.jsxs(c,{onClick:()=>{b(),g(null)},className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"دسته‌بندی جدید"]})}),e.jsxs(re,{className:"max-w-2xl max-h-[90vh]",style:{direction:"rtl",textAlign:"right"},children:[e.jsxs(ce,{style:{textAlign:"right"},children:[e.jsx(de,{style:{textAlign:"right"},children:u?"ویرایش دسته‌بندی":"ایجاد دسته‌بندی جدید"}),e.jsxs(me,{style:{textAlign:"right"},children:["دسته‌بندی قطعات برای ",o.name]})]}),e.jsx("div",{className:"max-h-[calc(90vh-8rem)] overflow-auto",children:e.jsxs("form",{onSubmit:X,className:"space-y-6",style:{direction:"rtl"},children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"name",style:{textAlign:"right",display:"block"},children:"نام دسته‌بندی *"}),e.jsx(C,{id:"name",value:r.name,onChange:s=>d(a=>({...a,name:s.target.value})),placeholder:"نام دسته‌بندی را وارد کنید",required:!0,style:{textAlign:"right",direction:"rtl"}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"parentId",style:{textAlign:"right",display:"block"},children:"دسته‌بندی والد (اختیاری)"}),e.jsxs(V,{value:r.parentId||"none",onValueChange:s=>d(a=>({...a,parentId:s==="none"?void 0:s})),children:[e.jsx(L,{style:{textAlign:"right",direction:"rtl"},children:e.jsx(z,{placeholder:"انتخاب کنید..."})}),e.jsxs(F,{style:{direction:"rtl"},children:[e.jsx(N,{value:"none",children:"هیچ کدام (دسته‌بندی اصلی)"}),i.filter(s=>s.id!==u?.id).map(s=>e.jsxs(N,{value:s.id,children:[$[s.name]||"📦"," ",s.name]},s.id))]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(j,{className:"text-base font-medium",children:"مشخصات فنی"}),e.jsxs(c,{type:"button",onClick:K,size:"sm",variant:"outline",children:[e.jsx(T,{className:"w-4 h-4 ml-1"}),"افزودن مشخصه"]})]}),e.jsx("div",{className:"space-y-3",children:r.technicalSpecs.map((s,a)=>e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(j,{className:"text-sm",children:"نام مشخصه"}),e.jsx(C,{value:s.name,onChange:t=>I(a,"name",t.target.value),placeholder:"مثال: قدرت",style:{textAlign:"right",direction:"rtl"}})]}),e.jsxs("div",{className:"w-32",children:[e.jsx(j,{className:"text-sm",children:"نوع"}),e.jsxs(V,{value:s.type,onValueChange:t=>I(a,"type",t),children:[e.jsx(L,{children:e.jsx(z,{})}),e.jsxs(F,{children:[e.jsx(N,{value:"text",children:"متن"}),e.jsx(N,{value:"number",children:"عدد"}),e.jsx(N,{value:"list",children:"لیست"}),e.jsx(N,{value:"boolean",children:"بله/خیر"})]})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(j,{className:"text-sm",children:"واحد"}),e.jsx(C,{value:s.unit,onChange:t=>I(a,"unit",t.target.value),placeholder:"مثال: HP",style:{textAlign:"right",direction:"rtl"}})]}),r.technicalSpecs.length>1&&e.jsx(c,{type:"button",onClick:()=>W(a),size:"sm",variant:"ghost",className:"text-red-600 hover:text-red-700 hover:bg-red-50 p-2",children:e.jsx(ue,{className:"w-4 h-4"})})]},a))})]}),e.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[e.jsx("div",{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{type:"button",variant:"outline",onClick:()=>p(!1),children:"انصراف"}),e.jsx(c,{type:"submit",children:u?"بروزرسانی":"ایجاد"})]})]})]})})]})]})]}),e.jsx(f,{className:"bg-blue-50 border-blue-200",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-800",children:o.name}),e.jsx("p",{className:"text-sm text-blue-600",children:o.description})]})]})})}),e.jsx("div",{className:"space-y-4",children:Q()}),i.length===0&&e.jsxs(f,{className:"p-8 text-center",children:[e.jsx(se,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"هیچ دسته‌بندی یافت نشد"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:["برای ",o.name,"، اولین دسته‌بندی قطعات را ایجاد کنید"]}),e.jsxs(c,{onClick:()=>{b(),g(null),p(!0)},className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"ایجاد دسته‌بندی"]})]})]}):e.jsxs("div",{className:"space-y-6",style:{direction:"rtl"},children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:"انتخاب نوع آسانسور برای مدیریت دسته‌بندی قطعات"})]})}),e.jsx(f,{className:"bg-blue-50 border-blue-200",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"راهنمای استفاده:"}),e.jsx("p",{children:"اب��دا نوع آسانسور مورد نظر خود را از لیست زیر انتخاب کنید، سپس می‌توانید دسته‌بندی‌های قطعات مربوط به آن نوع آسانسور را تعریف و مدیریت کنید."})]})]})})}),e.jsxs("div",{className:"relative",children:[e.jsx(he,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(C,{placeholder:"جستجو در انواع آسانسور...",value:v,onChange:s=>O(s.target.value),className:"pr-10",style:{textAlign:"right",direction:"rtl"}})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:H.map(s=>{const a=i.filter(t=>t.name.includes(s.name.split(" ")[1]||"")).length;return e.jsxs(f,{className:"cursor-pointer hover:shadow-lg transition-all duration-200 border-2 hover:border-blue-400 hover:scale-[1.02]",onClick:()=>J(s),children:[e.jsx(Y,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(Z,{className:"text-base leading-tight",children:s.name}),a>0&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[a," دسته‌بندی قطعات"]}),a===0&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"هنوز دسته‌بندی تعریف نشده"})]})]}),e.jsx(ee,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"})]})}),e.jsx(P,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 leading-relaxed",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{variant:s.isActive?"default":"secondary",className:"text-xs",children:s.isActive?"فعال":"غیرفعال"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.createdAt})]})]})})]},s.id)})}),H.length===0&&e.jsxs(f,{className:"p-8 text-center",children:[e.jsx(S,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"هیچ نوع آسانسوری یافت نشد"}),e.jsx("p",{className:"text-muted-foreground",children:v?"نتیجه‌ای برای جستجوی شما یافت نشد":"ابتدا انواع آسانسور را تعریف کنید"})]})]})}export{Le as default};
