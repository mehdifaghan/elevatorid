import{r as d,t as i,j as e,q as h,B as o,x as u,C as g,e as j,V as se,p as N,b as be,c as we,d as Ce,L as c,o as y,v as te,z as Ee,D as _e,E as ae,F as re,Q as Se}from"./index-tH8kGzNV.js";import{D as k,a as Ae,b as I,c as D,d as O,e as T}from"./dialog-DAjwwShP.js";import{D as Pe,a as ke,b as Ie,c as z}from"./dropdown-menu-BKfQT_JD.js";import{S as De,a as Oe,b as Te,c as Re,d as E}from"./select-B8NiX_r6.js";import{T as Ue}from"./textarea-1hTYB3HE.js";import{A as Le}from"./AdvancedTable-BFnDxHqp.js";import{Q as ie}from"./QRCodeGenerator-DzqPO6-F.js";import{P as Me}from"./PDFGenerator-Bp0TPodX.js";import{E as Fe}from"./ElevatorRegistrationForm-C4UDbIJW.js";import{r as p}from"./real-api-client-o-2gE2Hp.js";import{S as le}from"./square-pen-BV4EFpYT.js";import{S as $e}from"./save-DxawmBER.js";import{X as Ze}from"./x-B6dSK8zO.js";import{P as ze}from"./plus-A2-5MgKF.js";import{E as Ve}from"./ellipsis-J_HkHiqq.js";import"./index-DGGMjIYi.js";import"./Combination-Dzecd94B.js";import"./chevron-right-B97jr1RJ.js";import"./check-DV_4N94Y.js";import"./index-BdQq_4o_.js";import"./index-BuiImgyP.js";import"./table-DC3MYrD8.js";import"./search-8LTSveb2.js";import"./download-BGqk_jGh.js";import"./copy-CIVXPvX_.js";import"./file-text-DbNNqFYp.js";import"./PersianDatePicker-1MwY2jFT.js";import"./popover-B3pW-y7H.js";import"./utils-BvTIn9cQ.js";import"./ProvinceAndCitySelector-ByNK_lw_.js";import"./iran-provinces-cities-ClUeFN4S.js";const ne={active:"bg-green-100 text-green-800",maintenance:"bg-yellow-100 text-yellow-800",out_of_order:"bg-red-100 text-red-800",installing:"bg-blue-100 text-blue-800"},ce={active:"فعال",maintenance:"در تعمیر",out_of_order:"خارج از سرویس",installing:"در حال نصب"},de={passenger:"مسافربر",freight:"باربر",service:"خدماتی"};function Es(){const[R,V]=d.useState([]),[r,v]=d.useState(null),[f,oe]=d.useState(null),[me,U]=d.useState(!1),[L,_]=d.useState(!1),[M,F]=d.useState(!1),[S,xe]=d.useState(""),[b,he]=d.useState("all"),[$,q]=d.useState(!0),[Z,B]=d.useState(!1),[w,Q]=d.useState({total:0,active:0,maintenance:0,outOfOrder:0,installing:0}),[G,qe]=d.useState(1),[Be,pe]=d.useState(1),[H,X]=d.useState([]),[Qe,Ge]=d.useState([]),[C,J]=d.useState(!0),[m,x]=d.useState({municipalityZone:"",buildPermitNo:"",registryPlate:"",province:"",city:"",address:"",postalCode:""});d.useEffect(()=>{A(),K()},[G]);const K=async()=>{try{J(!0);const s=await p.get("/admin/elevators/stats"),t=s.stats||s,n={total:t.total||0,active:t.active||0,maintenance:t.maintenance||0,outOfOrder:t.outOfOrder||t.out_of_order||0,installing:t.installing||0};Q(n)}catch(s){if(console.error("Error fetching elevator stats:",s),s&&typeof s=="object"&&"isNetworkError"in s){const t=s;t.isNetworkError?i.error("عدم دسترسی به سرور برای دریافت آمار آسانسورها"):t.isAuthError?i.error("خطای احراز هویت در دریافت آمار"):i.error("خطا در بارگذاری آمار آسانسورها")}else i.error("خطا در بارگذاری آمار آسانسورها");Q({total:0,active:0,maintenance:0,outOfOrder:0,installing:0})}finally{J(!1)}},A=async()=>{try{q(!0);const s={page:G,size:15,...S&&{q:S},...b!=="all"&&{status:b}},t=await p.get("/admin/elevators",s),n=t.elevators||t.data||t||[],l=Array.isArray(n)?n.map(a=>({id:a.id?.toString()||a._id?.toString(),elevatorUid:a.elevator_uid||a.elevatorUid||a.uid||"نامشخص",uid:a.elevator_uid||a.elevatorUid||a.uid||"نامشخص",buildingName:a.building_name||a.buildingName||`ساختمان ${a.elevator_uid||a.elevatorUid}`,address:a.address||"آدرس نامشخص",provinceName:a.province_name||a.provinceName||a.province||"نامشخص",cityName:a.city_name||a.cityName||a.city||"نامشخص",postalCode:a.postal_code||a.postalCode||"",municipalityZone:a.municipality_zone||a.municipalityZone||"نامشخص",municipalRegion:a.municipality_zone||a.municipalityZone||"نامشخص",buildPermitNo:a.build_permit_no||a.buildPermitNo||"",buildingPermit:a.build_permit_no||a.buildPermitNo||"",registryPlate:a.registry_plate||a.registryPlate||"",registrationPlate:a.registry_plate||a.registryPlate||"",installerCompanyId:(a.installer_company_id||a.installerCompanyId||1).toString(),installerCompanyName:a.installer_company_name||a.installerCompanyName||"شرکت نصب‌کننده",ownerCompanyId:"1",ownerCompanyName:"شرکت مالک",installationDate:a.installation_date||a.installationDate||a.created_at?.split("T")[0]||a.createdAt?.split("T")[0]||new Date().toLocaleDateString("fa-IR"),status:a.status||(Math.random()>.7?"maintenance":"active"),elevatorType:a.elevator_type||a.elevatorType||(Math.random()>.5?"passenger":"freight"),capacity:a.capacity||Math.floor(Math.random()*10)+5,floors:a.floors||Math.floor(Math.random()*20)+3,parts:a.parts||[],createdAt:a.created_at||a.createdAt,updatedAt:a.updated_at||a.updatedAt,province:a.province||"",city:a.city||""})):[];V(l),pe(Math.ceil((t.total||l.length)/15))}catch(s){if(console.error("Error fetching elevators:",s),V([]),s&&typeof s=="object"&&"isNetworkError"in s){const t=s;t.isNetworkError?i.error("عدم دسترسی به سرور برای دریافت آسانسورها"):t.isAuthError?i.error("خطای احراز هویت در دریافت آسانسورها"):i.error("خطا در بارگذاری آسانسورها")}else i.error("خطا در بارگذاری آسانسورها")}finally{q(!1)}},P=async s=>{try{const t=await p.get(`/admin/elevators/${s}`),n=t.elevator||t.data||t;if(n)return oe(n),n}catch(t){if(console.error("Error fetching elevator details:",t),t&&typeof t=="object"&&"isNetworkError"in t){const n=t;n.isNetworkError?i.error("عدم دسترسی به سرور برای دریافت جزئیات آسانسور"):n.isAuthError?i.error("خطای احراز هویت در دریافت جزئیات"):i.error("خطا در بارگذاری جزئیات آسانسور")}else i.error("خطا در بارگذاری جزئیات آسانسور")}return null},ue=async()=>{try{const s=await p.get("/admin/parts",{page:1,size:100,owner_type:"company"}),t=s.parts||s.data||s||[],n=Array.isArray(t)?t.map(l=>({id:l.id||l._id,partUid:l.part_uid||l.partUid||l.uid||"نامشخص",title:l.title||l.name||"نامشخص",barcode:l.barcode||"",categoryId:l.category_id||l.categoryId||0,manufacturerCountry:l.manufacturer_country||l.manufacturerCountry||"نامشخص",originCountry:l.origin_country||l.originCountry||"نامشخص",registrantCompanyId:l.registrant_company_id||l.registrantCompanyId||0,currentOwner:l.current_owner||l.currentOwner||{type:"company"},createdAt:l.created_at||l.createdAt,updatedAt:l.updated_at||l.updatedAt})):[];X(n)}catch(s){if(console.error("Error fetching parts:",s),s&&typeof s=="object"&&"isNetworkError"in s){const t=s;t.isNetworkError?i.error("عدم دسترسی به سرور برای دریافت قطعات"):t.isAuthError?i.error("خطای احراز هویت در دریافت قطعات"):i.error("خطا در بارگذاری قطعات")}else i.error("خطا در بارگذاری قطعات");X([])}},W=async()=>{B(!0);try{await A(),await K(),i.success("داده‌ها با موفقیت به‌روزرسانی شد")}catch{i.error("خطا در به‌روزرسانی داده‌ها")}finally{B(!1)}},Y=async s=>{v(s),await P(s.id)},ge=async s=>{v(s),x({municipalityZone:s.municipalRegion||"",buildPermitNo:s.buildingPermit||"",registryPlate:s.registrationPlate||"",province:s.provinceName||"",city:s.cityName||"",address:s.address||"",postalCode:s.postalCode||""}),_(!0)},je=async()=>{if(r)try{await p.put(`/admin/elevators/${r.id}`,m),i.success("اطلاعات آسانسور با موفقیت به‌روزرسانی شد"),_(!1),await A()}catch(s){if(console.error("Error updating elevator:",s),s&&typeof s=="object"&&"isNetworkError"in s){const t=s;t.isNetworkError?i.error("عدم دسترسی به سرور برای به‌روزرسانی آسانسور"):t.isAuthError?i.error("خطای احراز هویت در به‌روزرسانی"):i.error("خطا در به‌روزرسانی اطلاعات آسانسور")}else i.error("خطا در به‌روزرسانی اطلاعات آسانسور")}},Ne=async s=>{v(s),await P(s.id),await ue(),F(!0)},fe=async s=>{if(r)try{await p.post(`/admin/elevators/${r.id}/parts`,{part_id:s,installed_at:new Date().toISOString()}),i.success("قطعه با موفقیت نصب شد"),await P(r.id)}catch(t){if(console.error("Error installing part:",t),t&&typeof t=="object"&&"isNetworkError"in t){const n=t;n.isNetworkError?i.error("عدم دسترسی به سرور برای نصب قطعه"):n.isAuthError?i.error("خطای احراز هویت در نصب قطعه"):i.error("خطا در نصب قطعه")}else i.error("خطا در نصب قطعه")}},ye=async s=>{if(r)try{await p.put(`/admin/elevators/${r.id}/parts/${s}`,{removed_at:new Date().toISOString()}),i.success("قطعه با موفقیت تعویض شد"),await P(r.id)}catch(t){if(console.error("Error replacing part:",t),t&&typeof t=="object"&&"isNetworkError"in t){const n=t;n.isNetworkError?i.error("عدم دسترسی به سرور برای تعویض قطعه"):n.isAuthError?i.error("خطای احراز هویت در تعویض قطعه"):i.error("خطا در تعویض قطعه")}else i.error("خطا در تعویض قطعه")}},ve=[{key:"uid",label:"شناسه آسانسور",sortable:!0,render:(s,t)=>e.jsx("div",{className:"font-medium",children:t.uid||t.elevatorUid})},{key:"buildingName",label:"نام ساختمان",sortable:!0,render:(s,t)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.buildingName||`ساختمان ${t.elevatorUid}`}),e.jsx("div",{className:"text-sm text-gray-500",children:t.municipalRegion||t.municipalityZone})]})},{key:"address",label:"آدرس",render:(s,t)=>e.jsx("div",{className:"max-w-xs truncate",children:t.address})},{key:"province",label:"استان/شهر",render:(s,t)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:t.provinceName||t.province}),e.jsx("div",{className:"text-gray-500",children:t.cityName||t.city})]})},{key:"elevatorType",label:"نوع آسانسور",sortable:!0,filterable:!0,render:(s,t)=>e.jsx(y,{variant:"secondary",className:"text-xs",children:de[t.elevatorType||"passenger"]})},{key:"capacity",label:"ظرفیت",sortable:!0,render:(s,t)=>e.jsxs("div",{className:"text-center",children:[t.capacity||8," نفر"]})},{key:"floors",label:"طبقات",sortable:!0,render:(s,t)=>e.jsx("div",{className:"text-center",children:t.floors||5})},{key:"status",label:"وضعیت",sortable:!0,filterable:!0,render:(s,t)=>e.jsx(y,{className:ne[t.status||"active"],children:ce[t.status||"active"]})},{key:"createdAt",label:"تاریخ ثبت",sortable:!0,render:(s,t)=>e.jsx("div",{className:"text-sm",children:t.createdAt?new Date(t.createdAt).toLocaleDateString("fa-IR"):"-"})},{key:"actions",label:"عملیات",render:(s,t)=>e.jsxs(Pe,{children:[e.jsx(ke,{asChild:!0,children:e.jsx(o,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(Ve,{className:"w-4 h-4"})})}),e.jsxs(Ie,{align:"end",className:"w-48",style:{direction:"rtl"},children:[e.jsxs(z,{onClick:()=>Y(t),className:"flex items-center gap-2",style:{textAlign:"right",justifyContent:"flex-end"},children:[e.jsx(Se,{className:"w-4 h-4"}),"مشاهده جزئیات"]}),e.jsxs(z,{onClick:()=>ge(t),className:"flex items-center gap-2",style:{textAlign:"right",justifyContent:"flex-end"},children:[e.jsx(le,{className:"w-4 h-4"}),"ویرایش اطلاعات"]}),e.jsxs(z,{onClick:()=>Ne(t),className:"flex items-center gap-2",style:{textAlign:"right",justifyContent:"flex-end"},children:[e.jsx(te,{className:"w-4 h-4"}),"مدیریت قطعات"]})]})]})}],ee=R.filter(s=>{const t=S.toLowerCase(),n=(s.uid||s.elevatorUid||"").toLowerCase().includes(t)||(s.buildingName||"").toLowerCase().includes(t)||(s.address||"").toLowerCase().includes(t)||(s.provinceName||s.province||"").toLowerCase().includes(t)||(s.cityName||s.city||"").toLowerCase().includes(t),l=b==="all"||s.status===b;return n&&l});return $?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(h,{className:"h-8 w-8 animate-spin mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:"در حال بارگذاری آسانسورها..."})]})}):e.jsxs("div",{className:"space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"مدیریت آسانسورها"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"لیست و مدیریت تمامی آسانسورهای ثبت‌شده در سیستم"})]}),e.jsxs(k,{open:me,onOpenChange:U,children:[e.jsx(Ae,{asChild:!0,children:e.jsxs(o,{className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(u,{className:"w-4 h-4 ml-2"}),"ثبت آسانسور جدید"]})}),e.jsxs(I,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",style:{direction:"rtl",textAlign:"right"},children:[e.jsxs(D,{className:"text-right shrink-0",dir:"rtl",children:[e.jsx(O,{className:"text-right",children:"ثبت آسانسور جدید"}),e.jsx(T,{className:"text-right",children:"اطلاعات آسانسور جدید را وارد کنید. تمامی فیلدهای ستاره‌دار الزامی می‌باشند."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto modal-scroll-container",children:e.jsx(Fe,{mode:"admin",onClose:()=>U(!1),onSubmit:async s=>{try{const t={municipality_zone:s.municipalRegion,build_permit_no:s.buildingPermit||"N/A",registry_plate:s.registrationPlate||"N/A",province:s.provinceName||"",city:s.cityName||"",address:s.address,postal_code:s.postalCode||"0000000000",installer_company_id:parseInt(s.installerCompanyId||"1"),parts:s.parts.map(a=>({part_id:a.partId}))},n=await p.post("/admin/elevators",t),l=n.elevator||n.data||n;if(l){const a=l.elevator_uid||l.elevatorUid||l.uid;i.success(`✅ آسانسور جدید با شناسه ${a} ثبت شد`),U(!1),await A()}else i.error("خطا در ثبت آسانسور")}catch(t){if(console.error("Error creating elevator:",t),t&&typeof t=="object"&&"isNetworkError"in t){const n=t;n.isNetworkError?i.error("عدم دسترسی به سرور برای ثبت آسانسور"):n.isAuthError?i.error("خطای احراز هویت در ثبت آسانسور"):i.error("خطا در ثبت آسانسور")}else i.error("خطا در ثبت آسانسور. لطفاً دوباره تلاش کنید.")}}})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx(g,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(u,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"کل آسانسورها"}),C?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"در حال بارگذاری..."})]}):e.jsx("p",{className:"text-2xl font-bold",children:w.total})]})]})})}),e.jsx(g,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(u,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"فعال"}),C?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"در حال بارگذاری..."})]}):e.jsx("p",{className:"text-2xl font-bold text-green-600",children:w.active})]})]})})}),e.jsx(g,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(se,{className:"w-5 h-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"در تعمیر"}),C?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"در حال بارگذاری..."})]}):e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:w.maintenance})]})]})})}),e.jsx(g,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(u,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"خارج از سرویس"}),C?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"در حال بارگذاری..."})]}):e.jsx("p",{className:"text-2xl font-bold text-red-600",children:w.outOfOrder})]})]})})}),e.jsx(g,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(u,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"در حال نصب"}),C?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"در حال بارگذاری..."})]}):e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:w.installing})]})]})})})]}),e.jsx(g,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(N,{placeholder:"جستجو بر اساس شناسه، نام ساختمان، آدرس یا شهر...",value:S,onChange:s=>xe(s.target.value),className:"w-full",style:{textAlign:"right",direction:"rtl"}})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs(De,{value:b,onValueChange:he,children:[e.jsx(Oe,{children:e.jsx(Te,{placeholder:"فیلتر وضعیت"})}),e.jsxs(Re,{children:[e.jsx(E,{value:"all",children:"همه وضعیت‌ها"}),e.jsx(E,{value:"active",children:"فعال"}),e.jsx(E,{value:"maintenance",children:"در تعمیر"}),e.jsx(E,{value:"out_of_order",children:"خارج از سرویس"}),e.jsx(E,{value:"installing",children:"در حال نصب"})]})]})})]})})}),e.jsxs(g,{children:[e.jsxs(be,{children:[e.jsx(we,{children:"لیست آسانسورها"}),e.jsxs(Ce,{children:[ee.length," آسانسور از مجموع ",R.length," آسانسور"]})]}),e.jsx(j,{children:$?e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(h,{className:"h-8 w-8 animate-spin mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:"در حال بارگذاری لیست آسانسورها..."})]})}):R.length===0&&!$?e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(u,{className:"h-12 w-12 text-muted-foreground mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-foreground",children:"هیچ آسانسوری یافت نشد"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"ممکن است مشکلی در اتصال به سرور وجود داشته باشد یا هنوز آسانسوری ثبت نشده باشد."})]}),e.jsx(o,{onClick:W,disabled:Z,variant:"outline",children:Z?e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"w-4 h-4 animate-spin ml-2"}),"در حال تلاش مجدد..."]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-4 h-4 ml-2"}),"تلاش مجدد"]})})]})}):e.jsx(Le,{data:ee,columns:ve,searchable:!1,exportable:!0,pagination:!0,pageSize:15,emptyMessage:"آسانسوری یافت نشد",onRowClick:s=>Y(s),onRefresh:W,refreshing:Z})})]}),r&&!L&&!M&&e.jsx(k,{open:!!r,onOpenChange:()=>v(null),children:e.jsxs(I,{className:"max-w-4xl max-h-[90vh] overflow-hidden",style:{direction:"rtl",textAlign:"right"},children:[e.jsxs(D,{className:"text-right",children:[e.jsxs(O,{className:"flex items-center gap-2",style:{textAlign:"right"},children:[e.jsx(u,{className:"w-5 h-5"}),"جزئیات آسانسور ",r.uid||r.elevatorUid]}),e.jsx(T,{className:"text-right",children:"اطلاعات کامل آسانسور و شناسنامه آن"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto modal-scroll-container",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"اطلاعات پایه"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"شناسه آسانسور"}),e.jsx("p",{className:"font-medium",children:r.uid||r.elevatorUid})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"نام ساختمان"}),e.jsx("p",{className:"font-medium",children:r.buildingName||`ساختمان ${r.elevatorUid}`})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"آدرس"}),e.jsx("p",{children:r.address})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"استان"}),e.jsx("p",{children:r.provinceName||r.province})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"شهر"}),e.jsx("p",{children:r.cityName||r.city})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"کد پستی"}),e.jsx("p",{children:r.postalCode})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"منطقه شهرداری"}),e.jsx("p",{children:r.municipalRegion||r.municipalityZone})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"مشخصات فنی"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"نوع آسانسور"}),e.jsx("div",{className:"font-medium",children:e.jsx(y,{variant:"secondary",children:de[r.elevatorType||"passenger"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"ظرفیت"}),e.jsxs("p",{children:[r.capacity||8," نفر"]})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"تعداد طبقات"}),e.jsxs("p",{children:[r.floors||5," طبقه"]})]})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"تاریخ ثبت"}),e.jsx("p",{children:r.createdAt?new Date(r.createdAt).toLocaleDateString("fa-IR"):"-"})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"وضعیت"}),e.jsx("div",{children:e.jsx(y,{className:ne[r.status||"active"],children:ce[r.status||"active"]})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"اطلاعات مجوزها"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"شماره پروانه ساختمان"}),e.jsx("p",{className:"font-medium",children:r.buildingPermit||r.buildPermitNo})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"شماره پلاک ثبتی"}),e.jsx("p",{className:"font-medium",children:r.registrationPlate||r.registryPlate})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"QR کد آسانسور"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(ie,{data:`https://elevatorid.ieeu.ir/elevator/${r.uid||r.elevatorUid}`,size:200})})]})]}),e.jsxs("div",{className:"p-6 border-t",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"قطعات نصب شده"}),f?.parts&&f.parts.length>0?e.jsx("div",{className:"space-y-2",children:f.parts.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.part?.title||`قطعه ${s.partId}`}),e.jsxs("p",{className:"text-sm text-gray-600",children:["شناسه قطعه: ",s.partId]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["تاریخ نصب: ",new Date(s.installedAt).toLocaleDateString("fa-IR")]})]}),e.jsx(y,{className:"bg-green-100 text-green-800",children:"نصب شده"})]},s.id))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"هیچ قطعه‌ای ثبت نشده است"})]}),e.jsxs("div",{className:"flex gap-3 p-6 border-t",children:[e.jsx(ie,{data:`https://elevatorid.ieeu.ir/elevator/${r.uid||r.elevatorUid}`,downloadButton:!0,filename:`elevator-${r.uid||r.elevatorUid}-qr`}),e.jsx(Me,{title:`شناسنامه آسانسور ${r.uid||r.elevatorUid}`,data:r,filename:`elevator-${r.uid||r.elevatorUid}-certificate.pdf`}),e.jsx(o,{variant:"outline",onClick:()=>v(null),children:"بستن"})]})]})]})}),r&&L&&e.jsx(k,{open:L,onOpenChange:_,children:e.jsxs(I,{className:"max-w-2xl",style:{direction:"rtl",textAlign:"right"},children:[e.jsxs(D,{className:"text-right",children:[e.jsxs(O,{className:"flex items-center gap-2",style:{textAlign:"right"},children:[e.jsx(le,{className:"w-5 h-5"}),"ویرایش اطلاعات آسانسور ",r.uid||r.elevatorUid]}),e.jsx(T,{className:"text-right",children:"اطلاعات آسانسور را ویرایش کنید"})]}),e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"municipalityZone",children:"منطقه شهرداری"}),e.jsx(N,{id:"municipalityZone",value:m.municipalityZone,onChange:s=>x(t=>({...t,municipalityZone:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"buildPermitNo",children:"شماره پروانه ساختمان"}),e.jsx(N,{id:"buildPermitNo",value:m.buildPermitNo,onChange:s=>x(t=>({...t,buildPermitNo:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"registryPlate",children:"شماره پلاک ثبتی"}),e.jsx(N,{id:"registryPlate",value:m.registryPlate,onChange:s=>x(t=>({...t,registryPlate:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"postalCode",children:"کد پستی"}),e.jsx(N,{id:"postalCode",value:m.postalCode,onChange:s=>x(t=>({...t,postalCode:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"province",children:"استان"}),e.jsx(N,{id:"province",value:m.province,onChange:s=>x(t=>({...t,province:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"city",children:"شهر"}),e.jsx(N,{id:"city",value:m.city,onChange:s=>x(t=>({...t,city:s.target.value}))})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"address",children:"آدرس"}),e.jsx(Ue,{id:"address",value:m.address,onChange:s=>x(t=>({...t,address:s.target.value})),rows:3})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs(o,{onClick:je,className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4"}),"ذخیره تغییرات"]}),e.jsxs(o,{variant:"outline",onClick:()=>_(!1),children:[e.jsx(Ze,{className:"w-4 h-4 ml-2"}),"انصراف"]})]})]})]})}),r&&M&&e.jsx(k,{open:M,onOpenChange:F,children:e.jsxs(I,{className:"max-w-4xl max-h-[90vh] overflow-hidden",style:{direction:"rtl",textAlign:"right"},children:[e.jsxs(D,{className:"text-right",children:[e.jsxs(O,{className:"flex items-center gap-2",style:{textAlign:"right"},children:[e.jsx(te,{className:"w-5 h-5"}),"مدیریت قطعات آسانسور ",r.uid||r.elevatorUid]}),e.jsx(T,{className:"text-right",children:"نصب، تعویض و مدیریت قطعات آسانسور"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto modal-scroll-container",children:e.jsxs(Ee,{defaultValue:"installed",className:"p-6",children:[e.jsxs(_e,{className:"grid w-full grid-cols-2",children:[e.jsx(ae,{value:"installed",children:"قطعات نصب شده"}),e.jsx(ae,{value:"available",children:"نصب قطعه جدید"})]}),e.jsx(re,{value:"installed",className:"space-y-4",children:f?.parts&&f.parts.length>0?e.jsx("div",{className:"space-y-3",children:f.parts.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.part?.title||`قطعه ${s.partId}`}),e.jsxs("p",{className:"text-sm text-gray-600",children:["شناسه قطعه: ",s.partId]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["تاریخ نصب: ",new Date(s.installedAt).toLocaleDateString("fa-IR")]}),s.removedAt&&e.jsxs("p",{className:"text-sm text-red-600",children:["تاریخ جابجایی: ",new Date(s.removedAt).toLocaleDateString("fa-IR")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:s.removedAt?"bg-red-100 text-red-800":"bg-green-100 text-green-800",children:s.removedAt?"تعویض شده":"نصب شده"}),!s.removedAt&&e.jsx(o,{size:"sm",variant:"outline",onClick:()=>ye(s.partId),children:"تعویض"})]})]},s.id))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"هیچ قطعه‌ای نصب نشده است"})}),e.jsx(re,{value:"available",className:"space-y-4",children:H.length>0?e.jsx("div",{className:"space-y-3",children:H.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:["شناسه: ",s.partUid]}),s.barcode&&e.jsxs("p",{className:"text-sm text-gray-600",children:["بارکد: ",s.barcode]})]}),e.jsxs(o,{size:"sm",onClick:()=>fe(s.id),className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4"}),"نصب"]})]},s.id))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"قطعه‌ای برای نصب موجود نیست"})})]})}),e.jsx("div",{className:"flex gap-3 p-6 border-t",children:e.jsx(o,{variant:"outline",onClick:()=>F(!1),children:"بستن"})})]})})]})}export{Es as default};
