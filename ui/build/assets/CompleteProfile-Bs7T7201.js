import{a as A,i as M,u as $,k as B,r as m,j as e,l as v,m as N,C as E,b as R,c as q,U,d as V,e as _,A as z,n as H,L as n,o as G,p as c,M as J,P as K,B as p,q as O,s as C,t as i}from"./index-tH8kGzNV.js";import{S as Q,a as W,b as X,c as Y,d as Z}from"./select-B8NiX_r6.js";import{T as w}from"./textarea-1hTYB3HE.js";import{S as ee}from"./SimpleProvinceAndCitySelector-DBGm5otx.js";import{F as ae}from"./file-text-DbNNqFYp.js";import{M as se}from"./mail-B9fXdK0_.js";import"./index-BdQq_4o_.js";import"./Combination-Dzecd94B.js";import"./index-BuiImgyP.js";import"./check-DV_4N94Y.js";import"./utils-BvTIn9cQ.js";import"./iran-provinces-cities-ClUeFN4S.js";function ue(){const S=A();M();const{login:P}=$(),{makeRequest:h}=B(),[r,u]=m.useState(!1),[g,f]=m.useState(null),[t,b]=m.useState(1),[a,T]=m.useState({profileType:"",companyName:"",tradeId:"",province:"",city:"",address:"",postalCode:"",ceoPhone:"",email:"",description:""}),y=[{value:"producer",label:"تولیدکننده",icon:"🏭"},{value:"installer",label:"نصاب",icon:"🔧"},{value:"maintenance",label:"نگهداری و تعمیرات",icon:"⚙️"},{value:"importer",label:"واردکننده",icon:"🌍"},{value:"distributor",label:"توزیع‌کننده",icon:"🚚"},{value:"inspector",label:"بازرس",icon:"🔍"},{value:"coop_org",label:"اتحادیه/سازمان",icon:"🏢"}],o=(s,d)=>{T(l=>({...l,[s]:d}))},k=()=>a.profileType?!a.companyName||a.companyName.length<3?(i.error("نام شرکت باید حداقل 3 کاراکتر باشد"),!1):!a.tradeId||a.tradeId.length<10?(i.error("شناسه ملی/اقتصادی معتبر نیست"),!1):!0:(i.error("لطفاً نوع فعالیت را انتخاب کنید"),!1),I=()=>a.province?a.city?!a.address||a.address.length<10?(i.error("آدرس باید حداقل 10 کاراکتر باشد"),!1):!a.postalCode||!/^\d{10}$/.test(a.postalCode)?(i.error("کد پستی باید 10 رقم باشد"),!1):!a.ceoPhone||!/^0\d{10}$/.test(a.ceoPhone)?(i.error("شماره تلفن ثابت معتبر نیست (مثال: 02112345678)"),!1):a.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)?(i.error("ایمیل معتبر نیست"),!1):!0:(i.error("لطفاً شهر را انتخاب کنید"),!1):(i.error("لطفاً استان را انتخاب کنید"),!1),F=()=>{t===1&&k()&&b(2)},L=()=>{t===2&&b(1)},D=async s=>{if(s.preventDefault(),!!I()){u(!0),f(null);try{if(await h(()=>C.updateMe({profileType:a.profileType,company:{name:a.companyName,tradeId:a.tradeId,province:a.province,city:a.city,address:a.address,postalCode:a.postalCode,ceoPhone:a.ceoPhone,email:a.email,description:a.description}}))){i.success("پروفایل شما با موفقیت تکمیل شد!");const l=await h(()=>C.getMe());if(l){const j=l.profiles?.[0]?.profileType==="coop_org"?"admin":"user";P({id:l.user.id,phone:l.user.phone,role:j,status:l.user.status,profiles:l.profiles}),setTimeout(()=>{S(j==="admin"?"/api/admin":"/api/user",{replace:!0})},1e3)}}}catch(d){console.error("Complete profile error:",d);const l=d?.response?.data?.message||"خطا در ثبت اطلاعات";f(l),i.error(l)}finally{u(!1)}}},x=y.find(s=>s.value===a.profileType);return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-4 relative overflow-hidden",dir:"rtl",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 via-purple-600/10 to-indigo-600/10 backdrop-blur-3xl"}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-300/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-300/20 rounded-full blur-3xl"}),e.jsxs("div",{className:"w-full max-w-3xl space-y-8 relative z-10",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl shadow-2xl",children:e.jsx(v,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-900 via-blue-800 to-indigo-800 bg-clip-text text-transparent",children:"تکمیل اطلاعات پروفایل"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"برای استفاده از سامانه، لطفاً اطلاعات زیر را تکمیل کنید"})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t>=1?"bg-blue-600 text-white":"bg-gray-200 text-gray-500"}`,children:t>1?e.jsx(N,{className:"w-5 h-5"}):"1"}),e.jsx("span",{className:t>=1?"text-blue-600 font-medium":"text-gray-500",children:"اطلاعات شرکت"})]}),e.jsx("div",{className:"w-16 h-1 bg-gray-200 rounded",children:e.jsx("div",{className:`h-full rounded transition-all duration-300 ${t>=2?"bg-blue-600 w-full":"bg-gray-200 w-0"}`})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t>=2?"bg-blue-600 text-white":"bg-gray-200 text-gray-500"}`,children:"2"}),e.jsx("span",{className:t>=2?"text-blue-600 font-medium":"text-gray-500",children:"اطلاعات تماس"})]})]}),e.jsxs(E,{className:"shadow-2xl border-0 bg-white/90 backdrop-blur-md ring-1 ring-gray-200/50",children:[e.jsxs(R,{className:"text-center pb-4",children:[e.jsxs(q,{className:"flex items-center justify-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-blue-600"}),t===1?"مرحله اول: اطلاعات شرکت":"مرحله دوم: اطلاعات تماس"]}),e.jsx(V,{children:t===1?"نوع فعالیت و مشخصات شرکت خود را وارد کنید":"آدرس و اطلاعات تماس خود را وارد کنید"})]}),e.jsxs(_,{className:"space-y-6 p-8",children:[g&&e.jsx(z,{className:"bg-gradient-to-r from-red-50 to-rose-50 border-red-200 shadow-sm",children:e.jsxs(H,{className:"text-red-700 font-medium",children:["⚠️ ",g]})}),e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[t===1&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"profileType",className:"text-right block text-gray-700 font-medium",children:"نوع فعالیت *"}),e.jsxs(Q,{value:a.profileType,onValueChange:s=>o("profileType",s),disabled:r,children:[e.jsx(W,{className:"bg-gray-50/80 border-gray-200 h-12 rounded-xl",children:e.jsx(X,{placeholder:"انتخاب کنید..."})}),e.jsx(Y,{children:y.map(s=>e.jsx(Z,{value:s.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s.icon}),e.jsx("span",{children:s.label})]})},s.value))})]}),x&&e.jsxs(G,{variant:"secondary",className:"gap-2",children:[e.jsx("span",{children:x.icon}),e.jsx("span",{children:x.label})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"companyName",className:"text-right block text-gray-700 font-medium",children:"نام شرکت *"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(c,{id:"companyName",type:"text",placeholder:"مثال: شرکت آسانسور سازان",value:a.companyName,onChange:s=>o("companyName",s.target.value),className:"text-right pr-12 bg-gray-50/80 border-gray-200 h-12 rounded-xl",disabled:r})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"tradeId",className:"text-right block text-gray-700 font-medium",children:"شناسه ملی / شناسه اقتصادی *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(c,{id:"tradeId",type:"text",placeholder:"10 یا 11 رقم",value:a.tradeId,onChange:s=>o("tradeId",s.target.value.replace(/\D/g,"")),className:"text-right pr-12 bg-gray-50/80 border-gray-200 h-12 rounded-xl",maxLength:11,disabled:r,dir:"ltr"})]})]})]}),t===2&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{className:"text-right block text-gray-700 font-medium",children:"استان و شهر *"}),e.jsx(ee,{selectedProvince:a.province,selectedCity:a.city,onProvinceChange:s=>o("province",s),onCityChange:s=>o("city",s),disabled:r})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"address",className:"text-right block text-gray-700 font-medium",children:"آدرس کامل *"}),e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute right-4 top-4 text-gray-400 w-5 h-5"}),e.jsx(w,{id:"address",placeholder:"آدرس دقیق شرکت را وارد کنید",value:a.address,onChange:s=>o("address",s.target.value),className:"text-right pr-12 bg-gray-50/80 border-gray-200 rounded-xl min-h-[100px]",disabled:r})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"postalCode",className:"text-right block text-gray-700 font-medium",children:"کد پستی *"}),e.jsx(c,{id:"postalCode",type:"text",placeholder:"1234567890",value:a.postalCode,onChange:s=>o("postalCode",s.target.value.replace(/\D/g,"")),className:"text-right bg-gray-50/80 border-gray-200 h-12 rounded-xl",maxLength:10,disabled:r,dir:"ltr"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"ceoPhone",className:"text-right block text-gray-700 font-medium",children:"تلفن ثابت *"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(c,{id:"ceoPhone",type:"tel",placeholder:"02112345678",value:a.ceoPhone,onChange:s=>o("ceoPhone",s.target.value.replace(/\D/g,"")),className:"text-right pr-12 bg-gray-50/80 border-gray-200 h-12 rounded-xl",maxLength:11,disabled:r,dir:"ltr"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"email",className:"text-right block text-gray-700 font-medium",children:"ایمیل (اختیاری)"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(c,{id:"email",type:"email",placeholder:"info@company.com",value:a.email,onChange:s=>o("email",s.target.value),className:"text-right pr-12 bg-gray-50/80 border-gray-200 h-12 rounded-xl",disabled:r,dir:"ltr"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"description",className:"text-right block text-gray-700 font-medium",children:"توضیحات (اختیاری)"}),e.jsx(w,{id:"description",placeholder:"توضیحات تکمیلی در مورد فعالیت شرکت",value:a.description,onChange:s=>o("description",s.target.value),className:"text-right bg-gray-50/80 border-gray-200 rounded-xl",disabled:r})]})]}),e.jsx("div",{className:"flex gap-3 pt-4",children:t===1?e.jsx(p,{type:"button",onClick:F,className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-4 rounded-xl font-semibold",disabled:r,children:"مرحله بعد ←"}):e.jsxs(e.Fragment,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:L,className:"flex-1 border-gray-300 py-4 rounded-xl font-semibold",disabled:r,children:"→ مرحله قبل"}),e.jsx(p,{type:"submit",className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white py-4 rounded-xl font-semibold",disabled:r,children:r?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(O,{className:"w-5 h-5 animate-spin"}),"در حال ثبت..."]}):e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:"w-5 h-5"}),"ثبت و ورود به سامانه"]})})]})})]})]})]})]})]})}export{ue as default};
