import{af as c,r as u,t as p,j as e,B as y,L as t,p as n,o as G}from"./index-tH8kGzNV.js";import{S as w,a as C,b as P,c as I,d as F}from"./select-B8NiX_r6.js";import{T as H}from"./textarea-1hTYB3HE.js";import{PersianDatePicker as Z}from"./PersianDatePicker-1MwY2jFT.js";import{P as ee}from"./ProvinceAndCitySelector-ByNK_lw_.js";const se={getAllParts:()=>c.get("/parts/all"),getAll:(l=1,h=10,d)=>c.get("/parts",{page:l,limit:h,...d}),getParts:l=>c.get("/parts",l),getPart:l=>c.get(`/parts/${l}`),createPart:l=>c.post("/parts",l),updatePart:(l,h)=>c.put(`/parts/${l}`,h),deletePart:l=>c.delete(`/parts/${l}`),transferPart:(l,h)=>c.post(`/parts/${l}/transfer`,h),getPartTransfers:(l,h)=>c.get(`/parts/${l}/transfers`,h),generatePartPDF:l=>c.post(`/parts/${l}/pdf`),generateQRCode:l=>c.post(`/parts/${l}/qr`),create:l=>c.post("/parts",l),delete:l=>c.delete(`/parts/${l}`)},ae={getCategories:l=>c.get("/categories",{flat:l}),getElevatorTypes:()=>c.get("/elevator-types"),createCategory:l=>c.post("/categories",l),updateCategory:(l,h)=>c.put(`/categories/${l}`,h),deleteCategory:l=>c.delete(`/categories/${l}`),getFeatures:l=>c.get("/features",{categoryId:l}),createFeature:l=>c.post("/features",l),updateFeature:(l,h)=>c.put(`/features/${l}`,h),deleteFeature:l=>c.delete(`/features/${l}`)},re=["مسکونی","اداری","تجاری","صنعتی","بیمارستان","هتل","آموزشی","مختلط"],le=[{value:"passenger",label:"مسافربر"},{value:"freight",label:"باربر"},{value:"service",label:"خدماتی"}],te=["منطقه 1","منطقه 2","منطقه 3","منطقه 4","منطقه 5","منطقه 6","منطقه 7","منطقه 8","منطقه 9","منطقه 10","منطقه 11","منطقه 12","منطقه 13","منطقه 14","منطقه 15","منطقه 16","منطقه 17","منطقه 18","منطقه 19","منطقه 20","منطقه 21","منطقه 22"],ie=[{id:"1",name:"شرکت توسعه ساختمان پارس"},{id:"2",name:"شرکت سرمایه‌گذاری آریا"},{id:"3",name:"شرکت مدیریت مراکز تجاری رز"},{id:"4",name:"شرکت ساختمانی نیاوران"}],de=[{id:"1",name:"شرکت نصب تکنولوژی"},{id:"2",name:"شرکت نصب سریع"},{id:"3",name:"شرکت ماشین‌سازی آریا"},{id:"4",name:"شرکت فناوری آسانسور پارس"}],S={موتور:"🔧",کنترل:"⚡",ایمنی:"🛡️",کابین:"🏠",درب:"🚪",کابل:"🔗",مکانیکی:"⚙️",الکترونیک:"💻",هیدرولیک:"💧"};function ge({onClose:l,onSubmit:h,mode:d,title:ne="ثبت آسانسور جدید"}){const[r,i]=u.useState({buildingName:"",buildingType:d==="user"?"":void 0,address:"",provinceId:void 0,provinceName:"",cityId:void 0,cityName:"",postalCode:"",municipalRegion:"",buildingPermit:"",registrationPlate:"",installationDate:"",elevatorType:"passenger",capacity:"",floors:"",description:"",ownerName:d==="user"?"":void 0,ownerPhone:d==="user"?"":void 0,ownerEmail:d==="user"?"":void 0,ownerCompanyId:d==="admin"?"":void 0,managerName:d==="user"?"":void 0,managerPhone:d==="user"?"":void 0,managerCompany:d==="user"?"":void 0,installerName:d==="user"?"":void 0,installerPhone:d==="user"?"":void 0,installerCompany:d==="user"?"":void 0,installerLicense:d==="user"?"":void 0,installerCompanyId:d==="admin"?"":void 0,parts:[]}),[T,U]=u.useState([]),[k,A]=u.useState([]),[b,R]=u.useState(null),[D,E]=u.useState([]),[q,L]=u.useState(!1),[$,V]=u.useState(!1),[j,z]=u.useState(null),[o,N]=u.useState({partId:0,partUid:"",title:"",category:"",categoryId:0,serialNumber:"",installationDate:"",warrantyDuration:"",notes:""}),[m,O]=u.useState(1),v=d==="user"?5:4;u.useEffect(()=>{J()},[]),u.useEffect(()=>{if(b){const s=k.filter(a=>a.categoryId===b.id&&a.currentOwner?.type==="company");E(s)}else E([])},[b,k]);const J=async()=>{try{L(!0);const s=await ae.getCategories(!0);if(s.success&&s.data){const g=(Array.isArray(s.data)?s.data:s.data.items||[]).filter(f=>f.isActive);U(g)}const a=await se.getParts({size:1e3,ownerType:"company"});if(a.success&&a.data){const x=a.data.items||a.data||[];let g=Array.isArray(x)?x:[];!Array.isArray(x)&&x.items&&(g=x.items||[]);const f=g.filter(Y=>Y.currentOwner?.type==="company");A(f)}}catch(s){console.error("Error loading categories and parts:",s),p.error("خطا در بارگذاری دسته‌بندی‌ها و قطعات"),U([]),A([])}finally{L(!1)}},K=async s=>{if(s.preventDefault(),!$)try{V(!0);const a=["buildingName","address","municipalRegion","elevatorType","capacity","floors","installationDate"];if(d==="user"?a.push("buildingType","ownerName","ownerPhone"):a.push("ownerCompanyId","installerCompanyId"),r.buildingPermit||i(g=>({...g,buildingPermit:"N/A"})),r.registrationPlate||i(g=>({...g,registrationPlate:"N/A"})),r.postalCode||i(g=>({...g,postalCode:"0000000000"})),a.filter(g=>{const f=r[g];return!f||typeof f=="string"&&f.trim()===""}).length>0){p.error("لطفاً تمام فیلدهای ضروری را پر کنید");return}if(!r.installationDate){p.error("لطفاً تاریخ نصب را انتخاب کنید");return}if(!r.provinceId||!r.cityId){p.error("لطفاً استان و شهر را انتخاب کنید");return}if(d==="user"&&r.ownerPhone&&!/^09\d{9}$/.test(r.ownerPhone)){p.error("شماره تلفن باید با 09 شروع شده و 11 رقم باشد");return}if(r.postalCode&&r.postalCode.length!==10){p.error("کد پستی باید 10 رقم باشد");return}await h(r)}catch(a){console.error("خطا در ثبت آسانسور:",a),p.error("خطا در ثبت آسانسور. لطفاً دوباره تلاش کنید.")}finally{V(!1)}},M=()=>{m<v&&O(m+1)},W=()=>{m>1&&O(m-1)},B=()=>{if(!j||!o.serialNumber){p.error("لطفاً قطعه و شماره سریال را وارد کنید");return}const s=k.find(x=>x.id===j);if(!s){p.error("قطعه انتخاب شده یافت نشد");return}const a={id:Date.now().toString(),partId:s.id,partUid:s.partUid,title:s.title,category:b?.title||"",categoryId:s.categoryId,serialNumber:o.serialNumber,installationDate:r.installationDate||o.installationDate,warrantyDuration:o.warrantyDuration,notes:o.notes};i(x=>({...x,parts:[...x.parts,a]})),N({partId:0,partUid:"",title:"",category:"",categoryId:0,serialNumber:"",installationDate:"",warrantyDuration:"",notes:""}),z(null),p.success(`قطعه ${s.title} اضافه شد`)},Q=s=>{i(a=>({...a,parts:a.parts.filter(x=>x.id!==s)})),p.success("قطعه حذف شد")},_=s=>{z(s.id),N(a=>({...a,partId:s.id,partUid:s.partUid,title:s.title,category:b?.title||"",categoryId:s.categoryId}))},X=()=>{switch(m){case 1:return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h3",{className:"font-medium text-blue-800 flex items-center gap-2 mb-4",children:"🏢 اطلاعات ساختمان"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"buildingName",className:"text-blue-700",children:["نام ساختمان ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(n,{id:"buildingName",placeholder:"نام ساختمان را وارد کنید",value:r.buildingName,onChange:s=>i(a=>({...a,buildingName:s.target.value})),className:"bg-white border-blue-300",required:!0})]}),d==="user"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"buildingType",className:"text-blue-700",children:["نوع ساختمان ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(w,{value:r.buildingType||"",onValueChange:s=>i(a=>({...a,buildingType:s})),children:[e.jsx(C,{className:"bg-white border-blue-300",children:e.jsx(P,{placeholder:"انتخاب کنید"})}),e.jsx(I,{children:re.map(s=>e.jsx(F,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"municipalRegion",className:"text-blue-700",children:["منطقه شهرداری ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(w,{value:r.municipalRegion,onValueChange:s=>i(a=>({...a,municipalRegion:s})),children:[e.jsx(C,{className:"bg-white border-blue-300",children:e.jsx(P,{placeholder:"انتخاب منطقه"})}),e.jsx(I,{children:te.map(s=>e.jsx(F,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsxs(t,{htmlFor:"address",className:"text-blue-700",children:["آدرس کامل ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(H,{id:"address",placeholder:"آدرس کامل ساختمان را وارد کنید",value:r.address,onChange:s=>i(a=>({...a,address:s.target.value})),className:"bg-white border-blue-300",rows:3,required:!0})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsxs(t,{className:"text-blue-700",children:["استان و شهر ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"p-3 bg-white border border-blue-300 rounded-md",children:e.jsx(ee,{value:{provinceId:r.provinceId,cityId:r.cityId},onChange:s=>i(a=>({...a,provinceId:s.provinceId,provinceName:s.provinceName||"",cityId:s.cityId,cityName:s.cityName||""})),required:!0,layout:"horizontal",placeholder:{province:"استان را انتخاب کنید",city:"شهر را انتخاب کنید"}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"postalCode",className:"text-blue-700",children:"کد پستی"}),e.jsx(n,{id:"postalCode",placeholder:"کد پستی 10 رقمی",value:r.postalCode,onChange:s=>i(a=>({...a,postalCode:s.target.value})),className:"bg-white border-blue-300",maxLength:10})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"buildingPermit",className:"text-blue-700",children:"شماره پروانه ساختمان"}),e.jsx(n,{id:"buildingPermit",placeholder:"شماره پروانه ساختمان",value:r.buildingPermit,onChange:s=>i(a=>({...a,buildingPermit:s.target.value})),className:"bg-white border-blue-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"registrationPlate",className:"text-blue-700",children:"پلاک ثبتی"}),e.jsx(n,{id:"registrationPlate",placeholder:"پلاک ثبتی",value:r.registrationPlate,onChange:s=>i(a=>({...a,registrationPlate:s.target.value})),className:"bg-white border-blue-300"})]})]})]})});case 2:return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("h3",{className:"font-medium text-green-800 flex items-center gap-2 mb-4",children:"🏗️ مشخصات آسانسور"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"elevatorType",className:"text-green-700",children:["نوع آسانسور ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(w,{value:r.elevatorType,onValueChange:s=>i(a=>({...a,elevatorType:s})),children:[e.jsx(C,{className:"bg-white border-green-300",children:e.jsx(P,{})}),e.jsx(I,{children:le.map(s=>e.jsx(F,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"capacity",className:"text-green-700",children:["ظرفیت (کیلوگرم) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(n,{id:"capacity",type:"number",placeholder:"مثال: 630",value:r.capacity,onChange:s=>i(a=>({...a,capacity:s.target.value})),className:"bg-white border-green-300",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"floors",className:"text-green-700",children:["تعداد طبقات ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(n,{id:"floors",type:"number",placeholder:"تعداد طبقات",value:r.floors,onChange:s=>i(a=>({...a,floors:s.target.value})),className:"bg-white border-green-300",min:"1",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"installationDate",className:"text-green-700",children:["تاریخ نصب ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Z,{value:r.installationDate,onChange:s=>i(a=>({...a,installationDate:s})),placeholder:"انتخاب تاریخ",className:"bg-white border-green-300"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(t,{htmlFor:"description",className:"text-green-700",children:"توضیحات اضافی"}),e.jsx(H,{id:"description",placeholder:"توضیحات اضافی در مورد آسانسور...",value:r.description||"",onChange:s=>i(a=>({...a,description:s.target.value})),className:"bg-white border-green-300",rows:3})]})]})]})});case 3:return d==="admin"?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("h3",{className:"font-medium text-purple-800 flex items-center gap-2 mb-4",children:"👥 اطلاعات مالک و نصاب"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"ownerCompanyId",className:"text-purple-700",children:["شرکت مالک ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(w,{value:r.ownerCompanyId||"",onValueChange:s=>i(a=>({...a,ownerCompanyId:s})),children:[e.jsx(C,{className:"bg-white border-purple-300",children:e.jsx(P,{placeholder:"انتخاب شرکت مالک"})}),e.jsx(I,{children:ie.map(s=>e.jsx(F,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"installerCompanyId",className:"text-purple-700",children:["شرکت نصاب ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(w,{value:r.installerCompanyId||"",onValueChange:s=>i(a=>({...a,installerCompanyId:s})),children:[e.jsx(C,{className:"bg-white border-purple-300",children:e.jsx(P,{placeholder:"انتخاب شرکت نصاب"})}),e.jsx(I,{children:de.map(s=>e.jsx(F,{value:s.id,children:s.name},s.id))})]})]})]})]})}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("h3",{className:"font-medium text-purple-800 flex items-center gap-2 mb-4",children:"👤 اطلاعات مالک"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"ownerName",className:"text-purple-700",children:["نام و نام خانوادگی مالک ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(n,{id:"ownerName",placeholder:"نام و نام خانوادگی",value:r.ownerName||"",onChange:s=>i(a=>({...a,ownerName:s.target.value})),className:"bg-white border-purple-300",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"ownerPhone",className:"text-purple-700",children:["شماره تماس مالک ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(n,{id:"ownerPhone",placeholder:"09xxxxxxxxx",value:r.ownerPhone||"",onChange:s=>i(a=>({...a,ownerPhone:s.target.value})),className:"bg-white border-purple-300",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"ownerEmail",className:"text-purple-700",children:"ایمیل مالک"}),e.jsx(n,{id:"ownerEmail",type:"email",placeholder:"example@domain.com",value:r.ownerEmail||"",onChange:s=>i(a=>({...a,ownerEmail:s.target.value})),className:"bg-white border-purple-300"})]})]}),e.jsxs("div",{className:"border-t border-purple-200 pt-4 mt-4",children:[e.jsx("h4",{className:"text-md font-medium text-purple-900 mb-4",children:"اطلاعات مدیر ساختمان (اختیاری)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"managerName",className:"text-purple-700",children:"نام مدیر ساختمان"}),e.jsx(n,{id:"managerName",placeholder:"نام و نام خانوادگی",value:r.managerName||"",onChange:s=>i(a=>({...a,managerName:s.target.value})),className:"bg-white border-purple-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"managerPhone",className:"text-purple-700",children:"شماره تماس مدیر"}),e.jsx(n,{id:"managerPhone",placeholder:"09xxxxxxxxx",value:r.managerPhone||"",onChange:s=>i(a=>({...a,managerPhone:s.target.value})),className:"bg-white border-purple-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"managerCompany",className:"text-purple-700",children:"شرکت مدیریت"}),e.jsx(n,{id:"managerCompany",placeholder:"نام شرکت مدیریت ساختمان",value:r.managerCompany||"",onChange:s=>i(a=>({...a,managerCompany:s.target.value})),className:"bg-white border-purple-300"})]})]})]})]})});case 4:return d==="admin"?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg border border-indigo-200",children:[e.jsx("h3",{className:"font-medium text-indigo-800 flex items-center gap-2 mb-4",children:"🔩 قطعات آسانسور"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-indigo-700",children:"انتخاب دسته‌بندی قطعه"}),q?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-600 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"در حال بارگذاری دسته‌بندی‌ها..."})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:T.map(s=>e.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-all ${b?.id===s.id?"bg-indigo-200 border-indigo-400 text-indigo-800":"bg-white border-indigo-300 hover:bg-indigo-50"}`,onClick:()=>R(s),children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-1",children:S[s.title]||"📦"}),e.jsx("div",{className:"text-sm font-medium",children:s.title})]})},s.id))})]}),b&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-indigo-700",children:"قطعات موجود در انبار شرکت:"}),e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"* فقط قطعاتی که در حال حاضر در مالکیت شرکت است نمایش داده می‌شود"}),D.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"قطعه‌ای در این دسته‌بندی یافت نشد"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 max-h-48 overflow-y-auto",children:D.map(s=>e.jsx("div",{className:`p-3 rounded border cursor-pointer transition-colors ${j===s.id?"bg-indigo-200 border-indigo-400 text-indigo-800":"bg-white border-indigo-300 hover:bg-indigo-50"}`,onClick:()=>_(s),children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium text-sm",children:s.title}),e.jsxs("div",{className:"text-xs text-gray-600",children:["UID: ",s.partUid]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["کشور: ",s.manufacturerCountry||"نامشخص"]})]})},s.id))})]}),j&&e.jsxs("div",{className:"space-y-4 mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-800",children:"اطلاعات نصب قطعه"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-blue-700",children:"قطعه انتخاب شده"}),e.jsxs("div",{className:"p-2 bg-white rounded border border-blue-300",children:[e.jsx("div",{className:"font-medium",children:o.title}),e.jsxs("div",{className:"text-sm text-gray-600",children:["UID: ",o.partUid]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-blue-700",children:"شماره سریال نصب شده *"}),e.jsx(n,{placeholder:"شماره سریال قطعه نصب شده",value:o.serialNumber,onChange:s=>N(a=>({...a,serialNumber:s.target.value})),className:"bg-white border-blue-300",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-blue-700",children:"مدت گارانتی (ماه)"}),e.jsx(n,{type:"number",placeholder:"24",value:o.warrantyDuration,onChange:s=>N(a=>({...a,warrantyDuration:s.target.value})),className:"bg-white border-blue-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-blue-700",children:"یادداشت‌ها"}),e.jsx(n,{placeholder:"توضیحات اضافی درباره نصب",value:o.notes,onChange:s=>N(a=>({...a,notes:s.target.value})),className:"bg-white border-blue-300"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{type:"button",onClick:B,disabled:!j||!o.serialNumber,className:"bg-indigo-600 hover:bg-indigo-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"اضافه کردن قطعه"})})]}),r.parts.length>0&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("h4",{className:"font-medium text-indigo-800",children:"قطعات اضافه شده:"}),e.jsx("div",{className:"space-y-2",children:r.parts.map(s=>e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-indigo-300 flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.title}),e.jsxs(G,{variant:"secondary",className:"text-xs",children:[S[s.category]||"📦"," ",s.category]})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{children:["UID قطعه: ",s.partUid]}),e.jsxs("div",{children:["سریال نصب: ",s.serialNumber]}),s.warrantyDuration&&e.jsxs("div",{children:["گارانتی: ",s.warrantyDuration," ماه"]}),s.notes&&e.jsxs("div",{className:"text-gray-500",children:["توضیحات: ",s.notes]})]})]}),e.jsx(y,{type:"button",variant:"outline",size:"sm",onClick:()=>Q(s.id),className:"text-red-600 border-red-300 hover:bg-red-50",children:"حذف"})]},s.id))})]})]})}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[e.jsx("h3",{className:"font-medium text-orange-800 flex items-center gap-2 mb-4",children:"🔧 اطلاعات نصاب"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"installerName",className:"text-orange-700",children:"نام نصاب"}),e.jsx(n,{id:"installerName",placeholder:"نام و نام خانوادگی نصاب",value:r.installerName||"",onChange:s=>i(a=>({...a,installerName:s.target.value})),className:"bg-white border-orange-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"installerPhone",className:"text-orange-700",children:"شماره تماس نصاب"}),e.jsx(n,{id:"installerPhone",placeholder:"09xxxxxxxxx",value:r.installerPhone||"",onChange:s=>i(a=>({...a,installerPhone:s.target.value})),className:"bg-white border-orange-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"installerCompany",className:"text-orange-700",children:"شرکت نصاب"}),e.jsx(n,{id:"installerCompany",placeholder:"نام شرکت نصب آسانسور",value:r.installerCompany||"",onChange:s=>i(a=>({...a,installerCompany:s.target.value})),className:"bg-white border-orange-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"installerLicense",className:"text-orange-700",children:"شماره مجوز نصاب"}),e.jsx(n,{id:"installerLicense",placeholder:"شماره مجوز یا پروانه کار",value:r.installerLicense||"",onChange:s=>i(a=>({...a,installerLicense:s.target.value})),className:"bg-white border-orange-300"})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6",children:[e.jsx("h4",{className:"text-md font-medium text-blue-900 mb-2",children:"خلاصه اطلاعات"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ساختمان:"})," ",r.buildingName," - ",r.buildingType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"آسانسور:"})," ",r.floors," طبقه، ",r.capacity," کیلوگرم"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"مالک:"})," ",r.ownerName," - ",r.ownerPhone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"موقعیت:"})," ",r.cityName,", ",r.provinceName]})]})]})]})});case 5:return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg border border-indigo-200",children:[e.jsx("h3",{className:"font-medium text-indigo-800 flex items-center gap-2 mb-4",children:"🔩 قطعات آسانسور"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-indigo-700",children:"انتخاب دسته‌بندی قطعه"}),q?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-600 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"در حال بارگذاری دسته‌بندی‌ها..."})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:T.map(s=>e.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-all ${b?.id===s.id?"bg-indigo-200 border-indigo-400 text-indigo-800":"bg-white border-indigo-300 hover:bg-indigo-50"}`,onClick:()=>R(s),children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-1",children:S[s.title]||"📦"}),e.jsx("div",{className:"text-sm font-medium",children:s.title})]})},s.id))})]}),b&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-indigo-700",children:"قطعات موجود در انبار شرکت:"}),e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"* فقط قطعاتی که در حال حاضر در مالکیت شرکت است نمایش داده می‌شود"}),D.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"قطعه‌ای در این دسته‌بندی یافت نشد"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 max-h-48 overflow-y-auto",children:D.map(s=>e.jsx("div",{className:`p-3 rounded border cursor-pointer transition-colors ${j===s.id?"bg-indigo-200 border-indigo-400 text-indigo-800":"bg-white border-indigo-300 hover:bg-indigo-50"}`,onClick:()=>_(s),children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium text-sm",children:s.title}),e.jsxs("div",{className:"text-xs text-gray-600",children:["UID: ",s.partUid]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["کشور: ",s.manufacturerCountry||"نامشخص"]})]})},s.id))})]}),j&&e.jsxs("div",{className:"space-y-4 mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-800",children:"اطلاعات نصب قطعه"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-blue-700",children:"قطعه انتخاب شده"}),e.jsxs("div",{className:"p-2 bg-white rounded border border-blue-300",children:[e.jsx("div",{className:"font-medium",children:o.title}),e.jsxs("div",{className:"text-sm text-gray-600",children:["UID: ",o.partUid]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-blue-700",children:"شماره سریال نصب شده *"}),e.jsx(n,{placeholder:"شماره سریال قطعه نصب شده",value:o.serialNumber,onChange:s=>N(a=>({...a,serialNumber:s.target.value})),className:"bg-white border-blue-300",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-blue-700",children:"مدت گارانتی (ماه)"}),e.jsx(n,{type:"number",placeholder:"24",value:o.warrantyDuration,onChange:s=>N(a=>({...a,warrantyDuration:s.target.value})),className:"bg-white border-blue-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-blue-700",children:"یادداشت‌ها"}),e.jsx(n,{placeholder:"توضیحات اضافی درباره نصب",value:o.notes,onChange:s=>N(a=>({...a,notes:s.target.value})),className:"bg-white border-blue-300"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{type:"button",onClick:B,disabled:!j||!o.serialNumber,className:"bg-indigo-600 hover:bg-indigo-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"اضافه کردن قطعه"})})]}),r.parts.length>0&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("h4",{className:"font-medium text-indigo-800",children:"قطعات اضافه شده:"}),e.jsx("div",{className:"space-y-2",children:r.parts.map(s=>e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-indigo-300 flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.title}),e.jsxs(G,{variant:"secondary",className:"text-xs",children:[S[s.category]||"📦"," ",s.category]})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{children:["UID قطعه: ",s.partUid]}),e.jsxs("div",{children:["سریال نصب: ",s.serialNumber]}),s.warrantyDuration&&e.jsxs("div",{children:["گارانتی: ",s.warrantyDuration," ماه"]}),s.notes&&e.jsxs("div",{className:"text-gray-500",children:["توضیحات: ",s.notes]})]})]}),e.jsx(y,{type:"button",variant:"outline",size:"sm",onClick:()=>Q(s.id),className:"text-red-600 border-red-300 hover:bg-red-50",children:"حذف"})]},s.id))})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6",children:[e.jsx("h4",{className:"text-md font-medium text-blue-900 mb-2",children:"خلاصه اطلاعات"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ساختمان:"})," ",r.buildingName," - ",r.buildingType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"آسانسور:"})," ",r.floors," طبقه، ",r.capacity," کیلوگرم"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"مالک:"})," ",r.ownerName," - ",r.ownerPhone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"موقعیت:"})," ",r.cityName,", ",r.provinceName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"تعداد قطعات:"})," ",r.parts.length," قطعه"]})]})]})]})});default:return null}};return e.jsxs("div",{className:"space-y-6 p-6",dir:"rtl",children:[v>1&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx("div",{className:"flex items-center space-x-4 rtl:space-x-reverse",children:Array.from({length:v},(s,a)=>a+1).map(s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${s<=m?"bg-black text-white":"bg-gray-200 text-gray-600"}`,children:s}),s<v&&e.jsx("div",{className:`h-1 w-16 mx-2 ${s<m?"bg-black":"bg-gray-200"}`})]},s))})}),e.jsxs("div",{className:`grid grid-cols-${v} gap-4 text-center text-sm mb-6`,children:[e.jsx("div",{className:m>=1?"text-black font-medium":"text-gray-500",children:"اطلاعات ساختمان"}),e.jsx("div",{className:m>=2?"text-black font-medium":"text-gray-500",children:"مشخصات آسانسور"}),e.jsx("div",{className:m>=3?"text-black font-medium":"text-gray-500",children:d==="admin"?"مالک و نصاب":"اطلاعات مالک"}),d==="user"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:m>=4?"text-black font-medium":"text-gray-500",children:"اطلاعات نصاب"}),e.jsx("div",{className:m>=5?"text-black font-medium":"text-gray-500",children:"قطعات آسانسور"})]}),d==="admin"&&e.jsx("div",{className:m>=4?"text-black font-medium":"text-gray-500",children:"قطعات آسانسور"})]})]}),e.jsxs("form",{onSubmit:K,className:"space-y-6",children:[X(),e.jsxs("div",{className:"flex justify-between pt-6 border-t",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx(y,{type:"button",variant:"outline",onClick:l,className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:"انصراف"}),m>1&&v>1&&e.jsx(y,{type:"button",variant:"outline",onClick:W,className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:"مرحله قبل"})]}),e.jsx("div",{className:"flex gap-3",children:m<v&&v>1?e.jsx(y,{type:"button",onClick:M,className:"bg-black hover:bg-gray-800 text-white",children:"مرحله بعد"}):e.jsx(y,{type:"submit",disabled:$,className:"bg-black hover:bg-gray-800 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:$?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"در حال ثبت..."]}):"ثبت آسانسور"})})]})]})]})}export{ge as E};
