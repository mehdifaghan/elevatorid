import{r,j as e,C as j,e as u,b as se,p as ae,B as g,V as te,O as le,W as k,o as C,U as ne,G as re,Q as ie,t as w,L as M}from"./index-tH8kGzNV.js";import{T as ce,a as de,b as F,c,d as oe,e as d}from"./table-DC3MYrD8.js";import{D as E,b as O,c as V,d as $,e as A}from"./dialog-DAjwwShP.js";import{D as me,a as xe,b as he,c as T}from"./dropdown-menu-BKfQT_JD.js";import{S as H,a as z,b as P,c as U,d as n}from"./select-B8NiX_r6.js";import{T as pe}from"./textarea-1hTYB3HE.js";import{S as je}from"./search-8LTSveb2.js";import{C as _}from"./circle-x-D2gTA4o0.js";import{C as ue}from"./clock-BiwlPOks.js";import{M as G}from"./message-square-Gum9_klA.js";import{E as ge}from"./ellipsis-J_HkHiqq.js";import{S as Ne}from"./send-DAIw7Hq6.js";import"./index-DGGMjIYi.js";import"./Combination-Dzecd94B.js";import"./x-B6dSK8zO.js";import"./chevron-right-B97jr1RJ.js";import"./check-DV_4N94Y.js";import"./index-BdQq_4o_.js";import"./index-BuiImgyP.js";const Q=[{id:"1",type:"profile_update",title:"درخواست به‌روزرسانی آدرس شرکت",description:"به دلیل تغییر محل دفتر، نیاز به به‌روزرسانی آدرس ثبت‌شده در سیستم داریم.",companyId:"1",companyName:"شرکت آسانسار تهران",submittedBy:"احمد محمدی",submitDate:"۱۴۰۲/۰۹/۱۵",status:"pending",priority:"medium"},{id:"2",type:"complaint",title:"شکایت از تأخیر در تایید انتقال",description:"درخواست انتقال قطعه با کد P001 بیش از ۲ هفته است که در انتظار تایید مانده است.",companyId:"2",companyName:"شرکت قطعات پارس",submittedBy:"مریم احمدی",submitDate:"۱۴۰۲/۰۹/۱۲",status:"in_review",priority:"high",adminResponse:"درخواست شما در حال بررسی است و تا پایان هفته پاسخ داده خواهد شد.",responseDate:"۱۴۰۲/۰۹/۱۳"},{id:"3",type:"support",title:"راهنمایی برای ثبت آسانسور جدید",description:"نحوه ثبت آسانسور جدید در سیستم را متوجه نمی‌شوم. لطفاً راهنمایی کنید.",companyId:"3",companyName:"شرکت نصب سریع",submittedBy:"علی رضایی",submitDate:"۱۴۰۲/۰۹/۱۰",status:"approved",priority:"low",adminResponse:"راهنمای کامل ثبت آسانسور برای شما ارسال شد. در صورت نیاز به راهنمایی بیشتر با پشتیبانی تماس بگیرید.",responseDate:"۱۴۰۲/۰۹/۱۱"}],W={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",in_review:"bg-blue-100 text-blue-800"},X={pending:"در انتظار",approved:"تایید شده",rejected:"رد شده",in_review:"در حال بررسی"},J={pending:ue,approved:k,rejected:_,in_review:le},K={low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",urgent:"bg-red-100 text-red-800"},Y={low:"کم",medium:"متوسط",high:"بالا",urgent:"فوری"},Z={profile_update:"به‌روزرسانی پروفایل",part_change:"تغییر قطعه",complaint:"شکایت",support:"پشتیبانی"};function He(){const[a,o]=r.useState(Q),[i,m]=r.useState(""),[N,f]=r.useState("all"),[p,S]=r.useState("all"),[l,x]=r.useState(null),[R,B]=r.useState(!1),[D,v]=r.useState(!1),q=async()=>{B(!0);try{await new Promise(s=>setTimeout(s,1e3)),o(Q),w.success("داده‌ها با موفقیت به‌روزرسانی شد")}catch{w.error("خطا در به‌روزرسانی داده‌ها")}finally{B(!1)}},b={total:a.length,pending:a.filter(t=>t.status==="pending").length,in_review:a.filter(t=>t.status==="in_review").length,approved:a.filter(t=>t.status==="approved").length,rejected:a.filter(t=>t.status==="rejected").length},I=a.filter(s=>{const t=s.title.toLowerCase().includes(i.toLowerCase())||s.companyName.toLowerCase().includes(i.toLowerCase())||s.submittedBy.toLowerCase().includes(i.toLowerCase()),h=N==="all"||s.status===N,y=p==="all"||s.type===p;return t&&h&&y}),L=s=>{o(t=>t.map(h=>h.id===s.id?{...h,status:"approved",responseDate:"۱۴۰۲/۰۹/۱۶"}:h)),w.success("درخواست تایید شد")},ee=s=>{x(s),v(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"درخواست‌ها و شکایات"}),e.jsx("p",{className:"text-muted-foreground",children:"بررسی و پاسخ به درخواست‌های کاربران"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[e.jsx(j,{className:"border-l-4 border-l-blue-500",children:e.jsx(u,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold text-blue-600",children:b.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"کل درخواست‌ها"})]})})}),e.jsx(j,{className:"border-l-4 border-l-yellow-500",children:e.jsx(u,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:b.pending}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"در انتظار"})]})})}),e.jsx(j,{className:"border-l-4 border-l-orange-500",children:e.jsx(u,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold text-orange-600",children:b.in_review}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"در حال بررسی"})]})})}),e.jsx(j,{className:"border-l-4 border-l-green-500",children:e.jsx(u,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold text-green-600",children:b.approved}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"تایید شده"})]})})}),e.jsx(j,{className:"border-l-4 border-l-red-500",children:e.jsx(u,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold text-red-600",children:b.rejected}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"رد شده"})]})})})]}),e.jsxs(j,{children:[e.jsx(se,{children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(je,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ae,{placeholder:"جستجو بر اساس عنوان یا شرکت...",value:i,onChange:s=>m(s.target.value),className:"pr-10"})]}),e.jsxs(g,{variant:"outline",size:"sm",onClick:q,disabled:R,className:"gap-2 shrink-0",children:[e.jsx(te,{className:`h-4 w-4 ${R?"animate-spin":""}`}),R?"در حال بارگذاری...":"تازه‌سازی"]}),e.jsxs(H,{value:N,onValueChange:f,children:[e.jsx(z,{className:"w-32",children:e.jsx(P,{placeholder:"وضعیت"})}),e.jsxs(U,{children:[e.jsx(n,{value:"all",children:"همه"}),e.jsx(n,{value:"pending",children:"در انتظار"}),e.jsx(n,{value:"in_review",children:"در حال بررسی"}),e.jsx(n,{value:"approved",children:"تایید شده"}),e.jsx(n,{value:"rejected",children:"رد شده"})]})]}),e.jsxs(H,{value:p,onValueChange:S,children:[e.jsx(z,{className:"w-40",children:e.jsx(P,{placeholder:"نوع درخواست"})}),e.jsxs(U,{children:[e.jsx(n,{value:"all",children:"همه انواع"}),e.jsx(n,{value:"profile_update",children:"به‌روزرسانی پروفایل"}),e.jsx(n,{value:"part_change",children:"تغییر قطعه"}),e.jsx(n,{value:"complaint",children:"شکایت"}),e.jsx(n,{value:"support",children:"پشتیبانی"})]})]})]})})}),e.jsxs(u,{children:[e.jsx("div",{className:"rounded-lg border",children:e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(F,{children:[e.jsx(c,{children:"عنوان درخواست"}),e.jsx(c,{children:"نوع"}),e.jsx(c,{children:"شرکت"}),e.jsx(c,{children:"ارسال‌کننده"}),e.jsx(c,{children:"تاریخ ثبت"}),e.jsx(c,{children:"اولویت"}),e.jsx(c,{children:"وضعیت"}),e.jsx(c,{children:"عملیات"})]})}),e.jsx(oe,{children:I.map(s=>{const t=J[s.status];return e.jsxs(F,{children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium max-w-xs truncate",children:s.title}),e.jsx("div",{className:"text-sm text-muted-foreground max-w-xs truncate",children:s.description})]})]})}),e.jsx(d,{children:e.jsx(C,{variant:"outline",children:Z[s.type]})}),e.jsx(d,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4 text-gray-500"}),s.companyName]})}),e.jsx(d,{children:s.submittedBy}),e.jsx(d,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 text-gray-500"}),s.submitDate]})}),e.jsx(d,{children:e.jsx(C,{variant:"secondary",className:K[s.priority],children:Y[s.priority]})}),e.jsx(d,{children:e.jsxs(C,{variant:"secondary",className:`${W[s.status]} flex items-center gap-1 w-fit`,children:[e.jsx(t,{className:"w-3 h-3"}),X[s.status]]})}),e.jsx(d,{children:e.jsxs(me,{children:[e.jsx(xe,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",children:e.jsx(ge,{className:"w-4 h-4"})})}),e.jsxs(he,{align:"end",children:[e.jsxs(T,{onClick:()=>x(s),children:[e.jsx(ie,{className:"w-4 h-4 ml-2"}),"مشاهده جزئیات"]}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(T,{onClick:()=>L(s),className:"text-green-600",children:[e.jsx(k,{className:"w-4 h-4 ml-2"}),"تایید"]}),e.jsxs(T,{onClick:()=>ee(s),className:"text-red-600",children:[e.jsx(_,{className:"w-4 h-4 ml-2"}),"رد"]})]})]})]})})]},s.id)})})]})}),I.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(G,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"درخواستی یافت نشد"})]})]})]}),l&&!D&&e.jsx(E,{open:!!l,onOpenChange:()=>x(null),children:e.jsxs(O,{className:"max-w-2xl",children:[e.jsxs(V,{children:[e.jsx($,{children:"جزئیات درخواست"}),e.jsx(A,{children:"اطلاعات کامل درخواست ثبت‌شده"})]}),e.jsx(fe,{request:l,onApprove:()=>{L(l),x(null)},onReject:()=>{v(!0)}})]})}),D&&l&&e.jsx(E,{open:D,onOpenChange:()=>{v(!1),x(null)},children:e.jsxs(O,{className:"max-w-2xl",children:[e.jsxs(V,{children:[e.jsx($,{children:"پاسخ به درخواست"}),e.jsx(A,{children:"علت رد یا پاسخ خود را ثبت کنید"})]}),e.jsx(ve,{request:l,onSubmit:(s,t)=>{o(h=>h.map(y=>y.id===l.id?{...y,status:t==="approve"?"approved":"rejected",adminResponse:s,responseDate:"۱۴۰۲/۰۹/۱۶"}:y)),v(!1),x(null),w.success(`درخواست ${t==="approve"?"تایید":"رد"} شد`)},onClose:()=>{v(!1),x(null)}})]})})]})}function fe({request:a,onApprove:o,onReject:i}){const m=J[a.status];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"اطلاعات درخواست"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"نوع:"}),e.jsx("span",{className:"mr-2 font-medium",children:Z[a.type]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"اولویت:"}),e.jsx(C,{className:`mr-2 ${K[a.priority]}`,children:Y[a.priority]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"تاریخ ثبت:"}),e.jsx("span",{className:"mr-2 font-medium",children:a.submitDate})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"وضعیت درخواست"}),e.jsxs(C,{variant:"secondary",className:`${W[a.status]} flex items-center gap-1 w-fit`,children:[e.jsx(m,{className:"w-3 h-3"}),X[a.status]]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"اطلاعات ارسال‌کننده"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"شرکت:"}),e.jsx("span",{className:"mr-2 font-medium",children:a.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ارسال‌کننده:"}),e.jsx("span",{className:"mr-2 font-medium",children:a.submittedBy})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"عنوان درخواست"}),e.jsx("p",{className:"font-medium",children:a.title})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"شرح درخواست"}),e.jsx("p",{className:"text-sm bg-gray-50 p-3 rounded-lg",children:a.description})]}),a.adminResponse&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"پاسخ مدیر"}),e.jsx("p",{className:"text-sm bg-blue-50 p-3 rounded-lg",children:a.adminResponse}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["تاریخ پاسخ: ",a.responseDate]})]}),a.status==="pending"&&e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsxs(g,{variant:"outline",onClick:i,children:[e.jsx(_,{className:"w-4 h-4 ml-2"}),"رد درخواست"]}),e.jsxs(g,{onClick:o,children:[e.jsx(k,{className:"w-4 h-4 ml-2"}),"تایید درخواست"]})]})]})}function ve({request:a,onSubmit:o,onClose:i}){const[m,N]=r.useState(""),[f,p]=r.useState("reject"),S=l=>{if(l.preventDefault(),!m.trim()){w.error("لطفاً پاسخ خود را وارد کنید");return}o(m,f)};return e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2",children:["درخواست: ",a.title]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:a.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"response",children:"پاسخ شما"}),e.jsx(pe,{id:"response",value:m,onChange:l=>N(l.target.value),placeholder:"پاسخ یا علت رد درخواست را وارد کنید...",rows:4,required:!0})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(M,{children:"نوع پاسخ:"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"action",value:"approve",checked:f==="approve",onChange:l=>p(l.target.value)}),e.jsx("span",{className:"text-green-600",children:"تایید"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"action",value:"reject",checked:f==="reject",onChange:l=>p(l.target.value)}),e.jsx("span",{className:"text-red-600",children:"رد"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(g,{type:"button",variant:"outline",onClick:i,children:"انصراف"}),e.jsxs(g,{type:"submit",children:[e.jsx(Ne,{className:"w-4 h-4 ml-2"}),"ارسال پاسخ"]})]})]})}export{He as default};
