import{a1 as ne,r as a,j as e,v as G,p as t,o as re,l as ce,U,P as V,M as z,B as N,I as oe,f as de,g as o,t as u}from"./index-tH8kGzNV.js";import{D as ie,b as me,c as xe,d as he,e as ue}from"./dialog-DAjwwShP.js";import{S as F,a as H,b as _,c as q,d as J}from"./select-B8NiX_r6.js";import{PersianDatePicker as ge}from"./PersianDatePicker-1MwY2jFT.js";import{S as K}from"./search-8LTSveb2.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],fe=ne("shopping-cart",je),Q=[{id:"P-001",name:"موتور آسانسور 1000 کیلو",code:"MOT-1000",serial:"M-2024-001",category:"موتور"},{id:"P-002",name:"کابل آسانسور 10 متری",code:"CAB-010",serial:"C-2024-002",category:"کابل"},{id:"P-003",name:"کنترلر هوشمند",code:"CTR-SMART",serial:"CT-2024-003",category:"کنترلر"},{id:"P-004",name:"درب آسانسور طلایی",code:"DOOR-GOLD",serial:"D-2024-004",category:"درب"},{id:"P-005",name:"دکمه‌های کابین",code:"BTN-CABIN",serial:"B-2024-005",category:"دکمه"},{id:"P-006",name:"ریل راهنما",code:"RAIL-GUIDE",serial:"R-2024-006",category:"ریل"},{id:"P-007",name:"موتور چرخ دنده",code:"MOT-GEAR",serial:"MG-2024-007",category:"موتور"},{id:"P-008",name:"سنسور طبقه",code:"SENS-FLOOR",serial:"S-2024-008",category:"سنسور"}];function we({isOpen:W,onClose:y,preSelectedPart:d,title:X="فروش قطعه",description:v="انجام فرآیند فروش قطعه"}){const[l,w]=a.useState(d||null),[i,C]=a.useState(""),[g,S]=a.useState(""),[Y,P]=a.useState(""),[f,p]=a.useState(null),[O,m]=a.useState(""),[M,x]=a.useState(""),[D,h]=a.useState(""),[Z,L]=a.useState(""),[ee,T]=a.useState(""),[se,k]=a.useState(""),[j,E]=a.useState(""),[c,B]=a.useState(!1),I=Q.filter(s=>i===""||s.name.toLowerCase().includes(i.toLowerCase())||s.code.toLowerCase().includes(i.toLowerCase())||s.serial.toLowerCase().includes(i.toLowerCase())),A=[{id:"CMP-001",name:"شرکت نصب سریع",code:"CMP-001",contactPerson:"احمد محمدی",phone:"09123456789",address:"تهران، خیابان ولیعصر، پلاک 123",ceos:[{id:"CEO-001-1",name:"علی احمدی",phone:"09111111111"},{id:"CEO-001-2",name:"سارا محمدی",phone:"09222222222"}]},{id:"CMP-002",name:"شرکت قطعات پارس",code:"CMP-002",contactPerson:"رضا حسینی",phone:"09987654321",address:"اصفهان، خیابان چهارباغ، پلاک 456",ceos:[{id:"CEO-002-1",name:"مهدی رضایی",phone:"09333333333"}]},{id:"CMP-003",name:"شرکت مونتاژ امین",code:"CMP-003",contactPerson:"فاطمه زارعی",phone:"09876543210",address:"شیراز، خیابان کریم‌خان، پلاک 789",ceos:[{id:"CEO-003-1",name:"امین زارعی",phone:"09444444444"},{id:"CEO-003-2",name:"نازنین احمدی",phone:"09555555555"}]},{id:"CMP-004",name:"شرکت آسانسار مدرن",code:"CMP-004",contactPerson:"حسن مرادی",phone:"09765432109",address:"مشهد، خیابان امام رضا، پلاک 321",ceos:[{id:"CEO-004-1",name:"حسن مرادی",phone:"09666666666"}]},{id:"CMP-005",name:"شرکت تعمیرات سریع",code:"CMP-005",contactPerson:"زهرا کریمی",phone:"09654321098",address:"تبریز، خیابان ارک، پلاک 654",ceos:[{id:"CEO-005-1",name:"مجید کریمی",phone:"09777777777"},{id:"CEO-005-2",name:"زهرا کریمی",phone:"09888888888"},{id:"CEO-005-3",name:"پوریا احمدی",phone:"09999999999"}]}],n={ceo:{name:"محمد رضا احمدی",phone:"09101010101"}},ae=s=>{P(s);const r=A.find(b=>b.id===s);r?(p(r),m(r.contactPerson),x(r.phone),h(r.address)):(p(null),m(""),x(""),h(""))},le=()=>{if(!l){u.error("ابتدا قطعه‌ای را انتخاب کنید");return}B(!0),u.success(`🔐 کد تایید به شماره ${n.ceo.phone} (${n.ceo.name}) ارسال شد`)},R=()=>{d||(w(null),C("")),S(""),P(""),p(null),m(""),x(""),h(""),L(""),T(""),k(""),E(""),B(!1)},te=()=>{if(!l){u.error("لطفاً ابتدا قطعه‌ای را انتخاب کنید");return}if(!c||j.length!==6){u.error("لطفاً کد تایید مدیرعامل را وارد کنید");return}u.success(`✅ فروش قطعه ${l.name} با تایید ${n.ceo.name} ثبت شد`),R(),y()},$=()=>{R(),y()};return e.jsx(ie,{open:W,onOpenChange:$,children:e.jsxs(me,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",dir:"rtl",children:[e.jsxs(xe,{className:"text-right flex-shrink-0",children:[e.jsxs(he,{className:"text-right flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-green-600"}),X]}),e.jsx(ue,{className:"text-right",children:d?`${v} ${d.name}`:v})]}),e.jsxs("div",{className:"space-y-6 py-4 overflow-y-auto flex-1 px-1",children:[!d&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),"انتخاب قطعه"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(t,{placeholder:"جستجو بر اساس نام، کد یا شماره سریال قطعه...",value:i,onChange:s=>C(s.target.value),className:"pr-10"})]}),e.jsxs(F,{value:l?.id||"",onValueChange:s=>{const r=Q.find(b=>b.id===s);w(r||null)},children:[e.jsx(H,{children:e.jsx(_,{placeholder:"انتخاب قطعه برای فروش"})}),e.jsxs(q,{dir:"rtl",className:"max-h-60",children:[I.map(s=>e.jsx(J,{value:s.id,children:e.jsxs("div",{className:"flex flex-col items-start w-full gap-1",children:[e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx(re,{variant:"outline",className:"text-xs",children:s.category})]}),e.jsxs("div",{className:"flex gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["کد: ",s.code]}),e.jsxs("span",{children:["سریال: ",s.serial]})]})]})},s.id)),I.length===0&&e.jsx("div",{className:"p-2 text-center text-muted-foreground text-sm",children:"قطعه‌ای با این مشخصات یافت نشد"})]})]})]})]}),l&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border",children:[e.jsxs("h3",{className:"font-medium mb-3 flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4 text-blue-600"}),"اطلاعات قطعه انتخاب شده"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"نام قطعه:"}),e.jsx("span",{className:"font-medium",children:l.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"کد قطعه:"}),e.jsx("span",{className:"font-medium font-mono",children:l.code})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"شماره سریال:"}),e.jsx("span",{className:"font-medium font-mono",children:l.serial})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"دسته‌بندی:"}),e.jsx("span",{className:"font-medium",children:l.category})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),"شرکت خریدار"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(t,{placeholder:"جستجو بر اساس نام یا کد شرکت...",value:g,onChange:s=>S(s.target.value),className:"pr-10"})]}),e.jsxs(F,{value:Y,onValueChange:ae,children:[e.jsx(H,{children:e.jsx(_,{placeholder:"انتخاب شرکت خریدار"})}),e.jsx(q,{dir:"rtl",children:A.filter(s=>g===""||s.name.toLowerCase().includes(g.toLowerCase())||s.code.toLowerCase().includes(g.toLowerCase())).map(s=>e.jsx(J,{value:s.id,children:e.jsxs("div",{className:"flex flex-col items-start w-full gap-1",children:[e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx("span",{className:"text-xs text-muted-foreground bg-gray-100 px-2 py-1 rounded",children:s.code})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["📞 ",s.phone," | 👤 ",s.contactPerson]})]})},s.id))})]})]})]}),f&&e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("h3",{className:"font-medium mb-3 flex items-center gap-2 text-green-800",children:"✅ اطلاعات خریدار (از پروفایل شرکت)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2 text-green-700",children:[e.jsx(U,{className:"w-4 h-4"}),"نام مسئول خرید"]}),e.jsx(t,{value:O,onChange:s=>m(s.target.value),className:"bg-white border-green-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2 text-green-700",children:[e.jsx(V,{className:"w-4 h-4"}),"شماره تماس"]}),e.jsx(t,{value:M,onChange:s=>x(s.target.value),className:"bg-white border-green-300"})]})]}),e.jsxs("div",{className:"space-y-2 mt-4",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2 text-green-700",children:[e.jsx(z,{className:"w-4 h-4"}),"آدرس شرکت"]}),e.jsx(t,{value:D,onChange:s=>h(s.target.value),className:"bg-white border-green-300"})]}),e.jsx("p",{className:"text-xs text-green-600 mt-2",children:"💡 این اطلاعات از پروفایل شرکت خریدار بارگذاری شده و قابل ویرایش است"})]}),!f&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"نام خریدار"]}),e.jsx(t,{placeholder:"ابتدا شرکت خریدار را انتخاب کنید",value:O,onChange:s=>m(s.target.value),disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),"شماره تماس"]}),e.jsx(t,{placeholder:"ابتدا شرکت خریدار را انتخاب کنید",value:M,onChange:s=>x(s.target.value),disabled:!0})]})]}),!f&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"آدرس"]}),e.jsx(t,{placeholder:"ابتدا شرکت خریدار را انتخاب کنید",value:D,onChange:s=>h(s.target.value),disabled:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"قیمت فروش (تومان)"}),e.jsx(t,{placeholder:"مبلغ به تومان",type:"number",value:Z,onChange:s=>L(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"تاریخ فروش"}),e.jsx(ge,{value:ee,onChange:T,placeholder:"انتخاب تاریخ فروش"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"یادداشت"}),e.jsx(t,{placeholder:"توضیحات اضافی (اختیاری)",value:se,onChange:s=>k(s.target.value)})]}),e.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border-2 border-yellow-200",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-yellow-800 flex items-center gap-2",children:"🔐 تایید مدیرعامل شرکت فروشنده"}),e.jsxs("p",{className:"text-sm text-yellow-700 mt-1",children:["کد تایید به شماره ",e.jsx("span",{className:"font-mono",children:n.ceo.phone})," (",e.jsx("strong",{children:n.ceo.name}),") ارسال خواهد شد"]})]}),e.jsx(N,{type:"button",variant:"outline",size:"sm",onClick:le,disabled:!l||c,className:"border-yellow-600 text-yellow-700 hover:bg-yellow-100",children:c?"✅ کد ارسال شد":"📤 ارسال کد تایید"})]}),c&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-medium text-yellow-800",children:["کد تایید ۶ رقمی ارسال شده به ",n.ceo.name]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(oe,{value:j,onChange:E,maxLength:6,dir:"ltr",children:e.jsxs(de,{className:"gap-1.5 sm:gap-2",children:[e.jsx(o,{index:0,className:"w-9 h-11 sm:w-11 sm:h-13 text-base sm:text-lg font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-100 bg-gray-50 focus:bg-white transition-all duration-200"}),e.jsx(o,{index:1,className:"w-9 h-11 sm:w-11 sm:h-13 text-base sm:text-lg font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-100 bg-gray-50 focus:bg-white transition-all duration-200"}),e.jsx(o,{index:2,className:"w-9 h-11 sm:w-11 sm:h-13 text-base sm:text-lg font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-100 bg-gray-50 focus:bg-white transition-all duration-200"}),e.jsx(o,{index:3,className:"w-9 h-11 sm:w-11 sm:h-13 text-base sm:text-lg font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-100 bg-gray-50 focus:bg-white transition-all duration-200"}),e.jsx(o,{index:4,className:"w-9 h-11 sm:w-11 sm:h-13 text-base sm:text-lg font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-100 bg-gray-50 focus:bg-white transition-all duration-200"}),e.jsx(o,{index:5,className:"w-9 h-11 sm:w-11 sm:h-13 text-base sm:text-lg font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-100 bg-gray-50 focus:bg-white transition-all duration-200"})]})})}),e.jsxs("p",{className:"text-xs text-yellow-600 text-center",children:["کد تایید به شماره ",e.jsx("span",{className:"font-mono",children:n.ceo.phone})," ارسال شده است"]})]})]})})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t bg-white sticky bottom-0 flex-shrink-0",children:[e.jsx(N,{variant:"outline",onClick:$,children:"انصراف"}),e.jsx(N,{className:"bg-green-600 hover:bg-green-700 text-white disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:!l||!c||j.length!==6,onClick:te,children:l?c?j.length!==6?"وارد کردن کد تایید":"✅ ثبت فروش":"ارسال کد تایید":"انتخاب قطعه"})]})]})})}export{we as S,fe as a};
